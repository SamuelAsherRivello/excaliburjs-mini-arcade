var ee=Object.defineProperty;var te=(r,i,e)=>i in r?ee(r,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[i]=e;var s=(r,i,e)=>te(r,typeof i!="symbol"?i+"":i,e);import{o as A,p as B,c as ie,q as O,d as n,r as g,s as v,_ as w,t as P,u as D,v as E,w as F,x as se,y as c,z as ae,A as oe}from"./vendor-CMquXB_j.js";import{R as ne,U as d,a as C,S as k,A as R,B as re,M as le,b as ce,O as M,E as z,c as de,G as he,d as Ae}from"./game-core-DUO-uM6r.js";const ue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEhwdrvaJaQAAAlFJREFUWIXtlrGL2lAcxz9nM4QuHhUUpMZFbiyc5JycOrTdDurWv6FIp9sKBbdO5eg/0MXNgkvR5XC4oajoLkJJBCGCQ1rK5SQ0HeyLUZOnp271C+Lj8fI+37zf7/sIHPW/6+RQGzWqFW/Y7pMrnAPw6s37rfY+iIFGteKJ8bDd9+fffvq6cf/YIQwE4eZoAoA5mlDWdW/DI/sb+PzutSfgnfoYLZOkUx9j9VyAjSZ2LsHqsZujiQ+PJ+ZwNauiZZKYowkfa7ehLGUXSHBOKDgv4M9LLxm2+1g9l7Kue9fd7pqJSAPBo12F5ArnS/UOKpVX0DJpPw2DWxNQOCtq0O2urY80IIPkCvN/q+dycZn214jjnv+aOIaDmlUBh059HMrZ2IRWz106XjE2RxPiCdd/UzEH4BgOjuH4Y5lCDYjaR0Fuak0AzooaN7XmEmTx1gvZU8VvzFWFdmajWvEERBxr2MZBiQQAPsyeLir85cf3UNajsMknxq8Pyun8YfvnbwCUUwUtk2TQslFmM1zbRawBGLRs4gmXZy+eMjVtAO7vYlI4SHogWEchkXFxEmKNWKdmVb9c4u1lcJBcRFelordqwJ4q/2KWjOzqeMLdGg6SGGqZJJ3eOsTquVgh8wL8EDhsuIqvSsWle9wxnKXGkmlbA5E9ELyGRfbVrEoqPy9DPOGSys/NrEZsWzhEpADCkyDMDFo293cxlNkM9fGfreIWJelNKEvCxWV6bf1D4VID193uySHjFiVpR8mS8M2o7w2HHT5Iyrru7VPzo446alV/ATMJU0+aN75bAAAAAElFTkSuQmCC",H="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEhwmH/1gTQAABJdJREFUaIHtWUFrK1UU/qqzGHSRB4FEgpmglCwEhea9FBdZFZ6VbgbMzo1/QES6cCOC0N1bFHn4B9zUVR9kYenbvFVAaUO7thYlE+ijgSyiFobH+OJi/G7P3LkzudO0ipAPyp2Z3pn5zjnfOffMDbDEEkv8r7Gy6AO+/fyj2er6GgDgw4+/WpHXASAYjeHVK2p+MBoDAB7t9xd+N7CgAYd7OzMAOD86BY3gucTq+pq6dtYPAACPB4P/1oDDvZ0ZSZH8+dEpzvoBmh1PzaPHiXAYquPbMOJGD6DngbS3CUncq1fUuTQAWNyIV4recLi3M3u2/xRAmjxJHvcucHkS4fIkAnAtG5J3Gy7chntz1gKFDKDnN7qbRs/LZC2VI7T9GoCYcDgMMZ04C5E1wdoAKZssyERudrzEORAbNZ04ieh89uDBTI5FYa0/WS7Pj05T5ZHQk5YIhyHchovLkwilcpQ4nk4cNVZbTqESax0BSR6AkXwWcXlM8l69glI5Ss2/PIkKRWNhUR73LtQxNS/BZKXHqy0H4TBEgDhS0vsc3YYLDOzeX7gKmciXyjExXfNAOlLhMMTWto+N7qa6V45AHIVP3nrfKgrWBrB06uSB2ItevZKaA1znBL3PZx3s9lRVkiPn2MLaAHpMT9K78H7br6FUtouClblszEykWON14mf9QOmcmE4c1W6Y7mMOxNG1i4RVBKR3edz2a2j7NWx0N7G17SfmkyBrPVFtOamWgn0TR1NlyoNVvdW7TtMqTGKy78mD7n0J3fjvfvspk2ehKiQjEYzGRqI25HXoUcgzToeVAfJDhfDqlUQ+ZC1s4TA0/k82c2z2OAKwrkbWEaBsstpnHbrG5XX+mWCKQl41KtxKAElPUTIyB4BrD1NqkrRabQ046weYThy1NsyLRKEkBswROO5dqBJoeinLKsFeSF4j8lpuUzLPNYDkn+0/NWpZrsiyp6EUsr7E8ghLZ8hzkwFzJcQEluRX19cSVYi12224yvvBaJyQnS6ZZsfL9LZ+PS8qVqlO2VDLeqlkD8OeX5LN8rxsBLkquw0XG91NfP/lDza0AFgm8affPFGhMyVfqRwpAgT7nTxUW06i3TY9dx5enTvjH6xGr38dTSNE0wjOvevAvbP+Bn49vcJ7H7yJ6e9XivzBbg+//PizmjedOHBfe6nIXj1/CefFC7z9bg33H3bw159/4P7DjvJ+teXAuefg6nl8T9ZqbCUh/QuJFcRtuAhGY9GNxq3GwW4v9QzpzVhWcalknsh8qbYc61bCqox+0e3MKJG8ZX5r21fkZeIxseU6QKOaHQ/HvQu0/Vqios0jTljlwKP9/gpfyiRlFWl2POM+T6kcKa9zEXMbriqzbb+GrW1fkb4JeWsD+ECvXlFelNLx6hWlex1p6SAhHdN7bMkDBbcWs3YLbiIdvbYXIS1R6CY2VabylrWiUuM6bkpYR+FdCbl1Qt3nrah3SR4ouC9UKkeJBiwuddmy0HGbxIlCEXg8GKywkuT1K9WWk5LZXZAHFviBQ//I0Bcf4O5ISyz0At2If4PwrcN2C3CJJZZYwoi/AXILu8sxhDv5AAAAAElFTkSuQmCC",U="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAcCAYAAAB75n/uAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEiIIgu52/wAAAphJREFUSInNVkFLG0EYfbsUwpI2SAJig1Aqpbukh8KKJeAlBw146CEIhv4G6S0FL948lAZPnvwFpYL1sF5cE8wloSgGUohkgyQRZNVAlhANSy6ZHsJMZ9ONXUogfafZb3be+94337cs4BFaSidu67FAS+kkNr/KSGPzq8SriDjWTP5FQEvp5DCrYXO6z2Kb030cZjVPpZqsA5r92sw1osk4i0eTcazNXHty4dnB/eml6/pvGCmgpXRSKBTY87N3r1zXhULhUReTccBnH5RC2LudRbleY/vleg17t7MISiEAj7twFdg+2YVlt2DZLRbbuHpwXdP3tk92vTnQUjqR+2EUexUYoukQya4kSHYlwTK17BYM0USxV4HcD7u6EIYDC5FlsjS1yIgN0UTX7uDzi6eIJuO4P71EuV7DxtUD/FIAcj8MYFDKTDuPs4tjB6fDQbXRJKpPYQeCUogRUHIAePNyDgAg98PsPQBQfQqqjabDhciTG8bNn0XkUK7XHJftBsO4cYg84Tcr1dGHf3zTWeaPiVSqNcjyc/YsDmdf7FVcD/KfCio0DHqWdyHSAAA070zQO8i088i08whKIag+BbEv39kEv8/9hOpT2MVm2nkAgzto3pngOVmJ+PJk2nmH0NLUIlQMRCgRJeffo+tKtQbl9dzvElHy9Na6YIgm/FKAdYZfCrB+V30KVJ/C5sMvBQAMOs4vBWCIJtJb6wLPybro08eEAAC5832ha3dg2S3WpnSQ+NblY5bdQtfuIHe+L/BcjhLxOLs4FhABUaGwzCkRzZjuyfbgcocHjMI1SLEQWSZ8zYMf3gIArK8lWHaLdc0ock+oNppEOyqR9M4BG570zgHRjkpkeGpdHRAy3l+cYUz+t+W/F/gFlx9vuXFG0UoAAAAASUVORK5CYII=",T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAcCAYAAAB75n/uAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEiIQkYLuqQAAAc5JREFUSInNlr9rFEEUxz975DCcWUSQPQSJl2JtttgDrUS2SXMcFkkglWyZIn+AaVKnsrNNrYWCe4VYaJ/KwoQsBAe5QyJiEAIuLAtbPItjl7nkTmcgB3nN7JuZ7/u+n8uAhUgUi0Sx2GAWbC6no6HNdQAa1oh5EUgUiyoyVJFhk6a5R2Bcg3Q0RJV5/W0qxhEEnRX8Zgu/2SLorFw9wVxFolgSL5Tei2N5uP1KEi80ngejCAYnR6gyZ28r4NHGY1SZMzg5MnLOiECVOavDr7z9Cbfvdfj25mNd8P+JURf5zRYAX96nANzv3qz3roQAYHc/pfs0AODTy9f0DHHGKdrbCmq9qoMRwcVueH6rM6FLFEvfbfP9QZfNu3B+OqL3bI2+2770y5iGbehTubZ4R/QVmOiW3f2Uz+8OmHY2DZuOhjjHy09m9vOH7Nd4ehddAFSRAUzoqszpu+1ZJsZFrgzBON96h6gyrw1Wq36mE+vYingBYOdcOVV4/o0lDv78YFD8dipDfrMll4wXWY2bhe27bWlU7EB9oBvXPf3X3jSsKjIcDCXxQtFzv352aIQ1HjTdY9MZsJbECyXxQqtXxdxT5IhYOWQt1+fZcm0J/gLZIuNghhtizgAAAABJRU5ErkJggg==",x="/assets/Background01-Bfgl5WSZ.png",G="/assets/Background02-C1FDw3ul.png",Z="/assets/Background03-CvnV8plf.png",I="data:image/png;base64,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",V="/assets/Shoot01-C3uAXra4.wav",X="/assets/Shoot02-feqa8JwR.wav",Q="/assets/Hit01-BScFQpPY.wav",W="/assets/Hit02-D7Q-SvHj.wav",Y="/assets/Britanic-2j_r9DuK.ttf",l=new ne;l.add("Asteroid01",new A(ue));l.add(H,new A(H));l.add(U,new A(U));l.add(T,new A(T));l.add(x,new A(x));l.add(G,new A(G));l.add(Z,new A(Z));l.add(I,new A(I));l.add(V,new B(V));l.add(X,new B(X));l.add(Q,new B(Q));l.add(W,new B(W));l.add(Y,new ie(Y,"Britanic",{filtering:O.Pixel,size:18}));const h=l;class f{static async AwaitNextFrameAsync(){await f.AwaitTimeAsync(1e3/30)}static async AwaitTimeAsync(i){await new Promise(e=>setTimeout(e,i))}static async ScaleUpAndFadeUpAsync(i){i.actions.clearActions(),i.scale=n(0,0),i.graphics.opacity=0;const e=new g(i,o=>{o.scaleTo(n(1,1),n(3,3))}),t=new g(i,o=>{o.fade(1,150)}),a=new v([e,t]);await i.actions.runAction(a)}static async ScaleDownAndFadeDownAsync(i){i.actions.clearActions();const e=new g(i,o=>{o.scaleTo(n(0,0),n(2,2))}),t=new g(i,o=>{o.fade(0,100)}),a=new v([e,t]);await i.actions.runAction(a)}static async ScaleUpAndDown(i){i.actions.clearActions();const e=new g(i,a=>{a.scaleTo(n(1.2,1.2),n(2,2)),a.scaleTo(n(1,1),n(2,2))}),t=new v([e]);await i.actions.runAction(t)}static async ScaleDownAndUp(i){i.actions.clearActions();const e=new g(i,a=>{a.scaleTo(n(.7,.7),n(4,4)),a.scaleTo(n(1,1),n(4,4))}),t=new v([e]);await i.actions.runAction(t)}}const J={pos:new w(100,100),velocity:new w(5,5),onAddedCallback:r=>{},generation:3,imageSource:h.get("Asteroid01"),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:30,unit:d.Percent},height:{value:30,unit:d.Percent},relativeTo:C.Screen,scaleAspectRatio:k.PrioritizeWidth}}};class y extends R{constructor(e){e={...J,...e};super(e);s(this,"RotationSpeed",Math.random()*.001-.003);s(this,"MaxGeneration",3);s(this,"_generation");s(this,"_onAddedCallback");this.pos=e.pos,this.vel=e.velocity,this._generation=e.generation,this._onAddedCallback=e.onAddedCallback,this.body.useGravity=!1}get configuration(){return this._configuration}get generation(){return this._generation}static createAndAdd(e,t,a,o,u){for(let p=0;p<t;p++){const b=u||new w(Math.random()*e.drawWidth,Math.random()*e.drawHeight),$=new w(Math.random()*100-50,Math.random()*100-50),S=J;S.pos=b,S.velocity=$,S.generation=a,S.onAddedCallback=o;const m=new y(S);e.add(m),m._onAddedCallback&&m._onAddedCallback(m)}}async onInitialize(e){const t=this.configuration.imageSource.toSprite(),a=this._generation/this.MaxGeneration;t.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource).scale(a),this.graphics.use(t);const o=.5;this.collider.set(new P({radius:Math.max(t.width/2,t.height/2)*o})),await f.ScaleUpAndFadeUpAsync(this)}onPreUpdate(e,t){this.rotation+=this.RotationSpeed,this.pos=new w((this.pos.x+e.drawWidth)%e.drawWidth,(this.pos.y+e.drawHeight)%e.drawHeight)}async takeDamage(e){this._generation>1&&Math.round(Math.random()*2)===1&&y.createAndAdd(e,3,this._generation-1,this._onAddedCallback,new w(this.pos.x,this.pos.y)),this.actions.clearActions(),await f.ScaleDownAndFadeDownAsync(this),this.kill()}}const pe=D.create("player"),N=D.create("bullet"),K=D.create("asteroid"),we=E.collidesWith([]),ge=E.collidesWith([K]),fe=E.collidesWith([N]),j={Player:we,Bullet:ge,Asteroid:fe,PlayerGroup:pe,BulletGroup:N,AsteroidGroup:K},L={imageSource:h.get("Bullet01"),collisionGroup:j.Bullet,collisionType:F.Active,layoutConfiguration:{sizeLayoutConfiguration:{width:{value:20,unit:d.Percent},height:{value:20,unit:d.Percent},relativeTo:C.Screen,scaleAspectRatio:k.PrioritizeWidth}}};class q extends R{constructor(e){e={...L,...e};super(e);s(this,"_lifespan",2e3);s(this,"_hasTakenDamage",!1);this.vel=e.vel??n(0,0),this.body.useGravity=!1}get configuration(){return this._configuration}async onInitialize(e){const t=this.configuration.imageSource.toSprite();t.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.use(t);const a=.5;this.collider.set(new P({radius:Math.max(t.width/2,t.height/2)*a})),this.rotation=Math.atan2(this.vel.y,this.vel.x),this.on("collisionstart",o=>{if(o.other instanceof y){if(this._hasTakenDamage)return;this._hasTakenDamage=!0,h.get("Hit02").play(),this.takeDamage(e),o.other.takeDamage(e)}}),e.clock.schedule(()=>{this.isKilled()||this.kill()},this._lifespan),await f.ScaleUpAndFadeUpAsync(this)}onPreKill(e){}async takeDamage(e){this.body.collisionType=F.PreventCollision,await f.ScaleDownAndFadeDownAsync(this),this.kill()}}s(q,"Speed",500);const _={imageSource:h.get("Ship01"),collisionGroup:j.Player,collisionType:F.Active,layoutConfiguration:{sizeLayoutConfiguration:{width:{value:15,unit:d.Percent},height:{value:15,unit:d.Percent},relativeTo:C.Screen,scaleAspectRatio:k.PrioritizeWidth},positionLayoutConfiguration:{x:{value:50,unit:d.Percent},y:{value:50,unit:d.Percent},relativeTo:C.Screen}}};class Se extends R{constructor(e=_){e={..._,...e};super(e);s(this,"MaxRotationSpeed",.05);s(this,"RotationAcceleration",5e-4);s(this,"RotationDeceleration",.001);s(this,"ThrustForce",200);s(this,"MaxSpeed",300);s(this,"DragCoefficient",.01);s(this,"BulletSpeed",800);s(this,"_currentRotationSpeed",0);s(this,"_rotationHoldTime",0);s(this,"_canShoot",!0);s(this,"_shootCooldown",250)}get configuration(){return this._configuration}onInitialize(){const e=this.configuration.imageSource.toSprite();e.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.add(e),this.collider.set(new P({radius:Math.max(e.width/2,e.height/2)}))}onPreUpdate(e,t){this.applyDrag(t),this.wrapAround(e),this.updateShootCooldown(t)}rotate(e,t,a){a!==0?(this._rotationHoldTime+=t,this._currentRotationSpeed+=this.RotationAcceleration*t*a):(this._rotationHoldTime=0,this._currentRotationSpeed>0?this._currentRotationSpeed=Math.max(0,this._currentRotationSpeed-this.RotationDeceleration*t):this._currentRotationSpeed<0&&(this._currentRotationSpeed=Math.min(0,this._currentRotationSpeed+this.RotationDeceleration*t)));const o=Math.min(this.MaxRotationSpeed,this._rotationHoldTime/500*this.MaxRotationSpeed);this._currentRotationSpeed=se(this._currentRotationSpeed,-o,o),this.rotation+=this._currentRotationSpeed}move(e,t){const a=n(Math.sin(this.rotation)*this.ThrustForce,-Math.cos(this.rotation)*this.ThrustForce);this.vel=this.vel.add(a.scale(t/1e3)),this.vel.size>this.MaxSpeed&&(this.vel=this.vel.normalize().scale(this.MaxSpeed))}shoot(e,t){if(!this._canShoot)return;this._canShoot=!1,this._shootCooldown=250;const a=n(Math.sin(this.rotation)*this.BulletSpeed,-Math.cos(this.rotation)*this.BulletSpeed),o=this.pos.add(a.normalize().scale(this.width/2)),u=L;u.pos=o,u.vel=a;const p=new q(u);p.z=this.z-1,e.add(p),h.get("Shoot01").play()}applyDrag(e){const t=this.vel.negate().scale(this.DragCoefficient*this.vel.size);this.vel=this.vel.add(t.scale(e/1e3))}wrapAround(e){this.pos=new w((this.pos.x+e.drawWidth)%e.drawWidth,(this.pos.y+e.drawHeight)%e.drawHeight)}updateShootCooldown(e){this._canShoot||(this._shootCooldown-=e,this._shootCooldown<=0&&(this._canShoot=!0))}}class ye extends re{constructor(e){super();s(this,"_ui");this._ui=new le(e)}set score(e){const t=e.toString().padStart(3,"0");this._ui.scoreText=`Score: ${t}​`}set lives(e){e=Math.max(0,e);const t="❤️",a="🖤",o=3,u=t.repeat(e),p=a.repeat(Math.max(0,o-e)),b=u+p;this._ui.livesText=`Lives: ${b}`}onInitialize(){this.addChild(this._ui),this._ui.buttonsText="⬅️⬆️​​➡️​🟦​, F, R​"}}class me extends ce{constructor(){super(...arguments);s(this,"_score",new M(0));s(this,"_lives",new M(0))}get score(){return this._score}get lives(){return this._lives}async initializeAsync(){await super.initializeAsync(),this._score.value=0,this._lives.value=3,this._score.refreshValueChanged(),this._lives.refreshValueChanged()}}class ve{constructor(){s(this,"_lastPointerDownTime",0);s(this,"_isPointerDown",!1);s(this,"_isPointerDoubleClick",!1);s(this,"actions");this.actions={left:{wasPressed:!1,isHeld:!1,wasReleased:!1},down:{wasPressed:!1,isHeld:!1,wasReleased:!1},right:{wasPressed:!1,isHeld:!1,wasReleased:!1},up:{wasPressed:!1,isHeld:!1,wasReleased:!1},action:{wasPressed:!1,isHeld:!1,wasReleased:!1},fullScreen:{wasPressed:!1,isHeld:!1,wasReleased:!1},resetGame:{wasPressed:!1,isHeld:!1,wasReleased:!1}},z.instance.input.pointers.primary.on("down",()=>{const i=Date.now();i-this._lastPointerDownTime<150&&(this._isPointerDoubleClick=!0),this._lastPointerDownTime=i,this._isPointerDown=!0}),z.instance.input.pointers.primary.on("up",()=>{this._isPointerDown=!1})}update(i,e){this.updateAction(i,"left",[c.A,c.Left]),this.updateAction(i,"right",[c.D,c.Right]),this.updateAction(i,"up",[c.W,c.Up]),this.updateAction(i,"down",[c.S,c.Down]),this.updateAction(i,"action",[c.Space,c.Enter]),this.updateAction(i,"fullScreen",[c.F]),this.updateAction(i,"resetGame",[c.R]),this.actions.action.wasPressed=this.actions.action.wasPressed||this._isPointerDown,this.actions.fullScreen.wasPressed=this.actions.fullScreen.wasPressed||this._isPointerDoubleClick,this._isPointerDoubleClick=!1}updateAction(i,e,t){const a=i.input.keyboard;this.actions[e]={wasPressed:t.some(o=>a.wasPressed(o)),isHeld:t.some(o=>a.isHeld(o)),wasReleased:t.some(o=>a.wasReleased(o))}}}class Ce extends de{constructor(){super();s(this,"input");this.input=new ve}update(e,t){this.input.update(e,t)}get left(){return this.input.actions.left}get right(){return this.input.actions.right}get up(){return this.input.actions.up}get down(){return this.input.actions.down}get action(){return this.input.actions.action}get fullScreen(){return this.input.actions.fullScreen}get resetGame(){return this.input.actions.resetGame}}class Be extends he{constructor(){console.log("retroFactor",1);const t={canvasElementId:"excaliburjs-game-canvas",width:900/1,height:1600/1,displayMode:ae.FitContainer,maxFps:120,physics:{solver:oe.Arcade},antialiasing:{pixelArtSampler:!0,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:O.Pixel,canvasImageRendering:"auto"},suppressPlayButton:!0};super(t);s(this,"_view");s(this,"_model");s(this,"_controller")}get model(){return this._model}get view(){return this._view}get controller(){return this._controller}async initializeAsync(){await super.initializeAsync(),this._model=new me,await this._model.initializeAsync(),this._view=new ye(this),await this._view.initializeAsync(),this.currentScene.add(this._view),this._model.score.onValueChanged.addEventListener(this.model_Score_onValueChanged.bind(this)),this._model.lives.onValueChanged.addEventListener(this.model_Lives_onValueChanged.bind(this)),this._controller=new Ce,await this._controller.initializeAsync(),await this._model.initializeAsync()}onPreUpdate(e,t){super.onPreUpdate(e,t),this.controller.update(e,t),this.controller.fullScreen.wasPressed&&(e.screen.isFullScreen?e.screen.exitFullScreen():e.screen.goFullScreen()),this.controller.resetGame.wasPressed&&console.log("todo: make reset")}checkGameOver(){}model_Score_onValueChanged(e,t){this._view.score=t,this.checkGameOver()}model_Lives_onValueChanged(e,t){this._view.lives=t,this.checkGameOver()}}class De extends Be{constructor(){super();s(this,"_background");s(this,"_player")}async initializeAsync(){if(this.isInitialized)return Promise.resolve();await h.initializeAsync(),this.start(h.loader),await super.initializeAsync(),this.initializeBackgrounds(),this.initializePlayer(),this.initializeAsteroids()}onPreUpdate(e,t){super.onPreUpdate(e,t),this.handlePlayerInput(e,t)}initializeBackgrounds(){const e={imageSource:h.get("Background02"),isScrolling:!0,scrollVelocity:n(15,30)};this._background=new Ae(e),this.currentScene.add(this._background)}initializePlayer(){this._player=new Se(_),this.currentScene.add(this._player)}initializeAsteroids(){y.createAndAdd(this,3,3,this.asteroid_onCreate.bind(this))}handlePlayerInput(e,t){this._player&&(this.controller.left.isHeld?this._player.rotate(e,t,-1):this.controller.right.isHeld?this._player.rotate(e,t,1):this._player.rotate(e,t,0),this.controller.up.isHeld&&this._player.move(e,t),this.controller.action.wasPressed&&this._player.shoot(e,t))}checkGameOver(){this.model.lives.value<=0&&console.log("Gameover")}asteroid_onCreate(e){e.on("kill",()=>{this.model.score.value+=10*e.generation})}}export{De as A,f as M,h as a};
