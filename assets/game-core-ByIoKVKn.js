var P=Object.defineProperty;var k=(n,e,t)=>e in n?P(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>k(n,typeof e!="symbol"?e+"":e,t);import{_ as g,a as m,b as V,c as F,d as W,e as z,f as H,g as R,h as o,i as u,j as w,k as U,l as q,m as B,n as D,o as E,p as N,q as M,r as _,s as $,t as O}from"./vendor-B7mi3kXY.js";class d{}r(d,"instance");var f=(n=>(n[n.Pixel=0]="Pixel",n[n.Percent=1]="Percent",n))(f||{}),v=(n=>(n[n.ImageSource=0]="ImageSource",n[n.Screen=1]="Screen",n))(v||{}),b=(n=>(n[n.Ignore=0]="Ignore",n[n.PrioritizeWidth=1]="PrioritizeWidth",n[n.PrioritizeHeight=2]="PrioritizeHeight",n))(b||{});const j={width:{value:100,unit:1},height:{value:100,unit:1},relativeTo:0,scaleAspectRatio:0},Z={x:{value:50,unit:1},y:{value:50,unit:1},relativeTo:1},T={sizeLayoutConfiguration:j,positionLayoutConfiguration:Z};class y{constructor(e=T){r(this,"_configuration");this._configuration=e}get configuration(){return this._configuration}screenWidthCurrent(){return d.instance.screen.resolution.width}screenHeightCurrent(){return d.instance.screen.resolution.height}screenWidthOriginal(){return d.instance.screen.canvasWidth}screenHeightOriginal(){return d.instance.screen.canvasHeight}screenWidthFactor(){return this.screenWidthCurrent()/this.screenWidthOriginal()}screenHeightFactor(){return this.screenHeightCurrent()/this.screenHeightOriginal()}getCalculatedWidth(e){let t=-1;switch(this.validateConfiguration(e),this._configuration.sizeLayoutConfiguration.relativeTo){case 1:this._configuration.sizeLayoutConfiguration.width.unit===1?t=this.screenWidthCurrent()*(this._configuration.sizeLayoutConfiguration.width.value/100):this._configuration.sizeLayoutConfiguration.width.unit===0&&(t=this._configuration.sizeLayoutConfiguration.width.value);break;case 0:e&&(this._configuration.sizeLayoutConfiguration.width.unit===1?t=e.width*(this._configuration.sizeLayoutConfiguration.width.value/100):this._configuration.sizeLayoutConfiguration.width.unit===0&&(t=this._configuration.sizeLayoutConfiguration.width.value));break;default:throw new Error("Invalid relativeTo configuration")}return t}getCalculatedHeight(e){let t=-1;switch(this.validateConfiguration(e),this._configuration.sizeLayoutConfiguration.relativeTo){case 1:this._configuration.sizeLayoutConfiguration.height.unit===1?t=this.screenHeightCurrent()*(this._configuration.sizeLayoutConfiguration.height.value/100):this._configuration.sizeLayoutConfiguration.height.unit===0&&(t=this._configuration.sizeLayoutConfiguration.height.value);break;case 0:e&&(this._configuration.sizeLayoutConfiguration.height.unit===1?t=e.height*(this._configuration.sizeLayoutConfiguration.height.value/100):this._configuration.sizeLayoutConfiguration.height.unit===0&&(t=this._configuration.sizeLayoutConfiguration.height.value));break;default:throw new Error("Invalid relativeTo configuration")}return t}getCalculatedScale(e){this.validateConfiguration(e);const t=this.getCalculatedWidth(e),i=this.getCalculatedHeight(e);switch(this._configuration.sizeLayoutConfiguration.scaleAspectRatio){case 0:return new g(t/e.width,i/e.height);case 1:const s=t/(e.width/e.height);return new g(t/e.width,s/e.height);case 2:const a=i*(e.width/e.height);return new g(a/e.width,i/e.height);default:throw new Error("Invalid aspect ratio configuration")}}getCalculatedPosition(e){let t=new g(0,0);if(!this._configuration.positionLayoutConfiguration)return t;switch(this.validateConfiguration(e),this._configuration.positionLayoutConfiguration.relativeTo){case 1:this._configuration.positionLayoutConfiguration.x.unit===1?t.x=this.screenWidthCurrent()*(this._configuration.positionLayoutConfiguration.x.value/100):this._configuration.positionLayoutConfiguration.x.unit===0&&(t.x=this._configuration.positionLayoutConfiguration.x.value),this._configuration.positionLayoutConfiguration.y.unit===1?t.y=this.screenHeightCurrent()*(this._configuration.positionLayoutConfiguration.y.value/100):this._configuration.positionLayoutConfiguration.y.unit===0&&(t.y=this._configuration.positionLayoutConfiguration.y.value);break;case 0:e&&(this._configuration.positionLayoutConfiguration.x.unit===1?t.x=e.width*(this._configuration.positionLayoutConfiguration.x.value/100):this._configuration.positionLayoutConfiguration.x.unit===0&&(t.x=this._configuration.positionLayoutConfiguration.x.value),this._configuration.positionLayoutConfiguration.y.unit===1?t.y=e.height*(this._configuration.positionLayoutConfiguration.y.value/100):this._configuration.positionLayoutConfiguration.y.unit===0&&(t.y=this._configuration.positionLayoutConfiguration.y.value));break;default:throw new Error("Invalid relativeTo  configuration")}return t}validateConfiguration(e){if(this._configuration.sizeLayoutConfiguration.relativeTo==0&&!e)throw new Error(`${this.constructor.name}. size is required when relativeTo = ${this._configuration.sizeLayoutConfiguration.relativeTo}`)}}r(y,"RetroFactor",Math.round(Math.random()*2)+1);class K extends m{constructor(t){let i;t.layoutConfiguration?i=new y(t.layoutConfiguration):i=new y(T),t.width||(t.width=i.getCalculatedWidth(t.imageSource)),t.height||(t.height=i.getCalculatedHeight(t.imageSource)),t.pos||(t.pos=i.getCalculatedPosition(t.imageSource));super(t);r(this,"_layoutEngine");r(this,"_configuration");this._configuration=t,this._layoutEngine=i}get configuration(){return this._configuration}get layoutEngine(){return this._layoutEngine}get width(){return this.layoutEngine.getCalculatedWidth(this._configuration.imageSource)}get height(){return this.layoutEngine.getCalculatedHeight(this._configuration.imageSource)}onInitialize(t){if(super.onInitialize(t),this.children.length>0){console.log(this.constructor.name+" already has children. 1. Allow ActorAdvanced to do it or just dont call super.onInitialize()");return}const i=this.configuration.imageSource.toSprite();if(i.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.use(i),this.configuration.collisionType!=V.PreventCollision){const s=F.Box(i.width,i.height,this.anchor);this.collider.set(s)}}}class J{constructor(){r(this,"_isInitialized",!1);r(this,"resources",{});r(this,"_loader");this._loader=new W}get loader(){return this._loader}get isInitialized(){return this._isInitialized}async initializeAsync(){this._isInitialized||(this._isInitialized=!0)}requireIsInitialized(){if(!this._isInitialized)throw new Error("ResourceCollection is not initialized. Call initializeAsync() first.")}nameOf(e){let t;if(typeof e=="object"&&e.default)t=e.default;else if(typeof e=="string")t=e;else throw new Error("Invalid import path");const i=t.match(/([^\/]+)(?=\.\w+$)/);return i?i[0]:t}add(e,t,i,s){let a;if(i?a=i:typeof e=="string"?a=this.nameOf(e):a=this.nameOf(e),this.has(a))throw new Error(`${this.constructor.name}.add() Failed. Name '${a}' already exists.`);t instanceof z&&s?this.resources[a]=new z(t.path,a,s):this.resources[a]=t,this.loader.addResource(this.resources[a])}has(e){return e in this.resources}get(e){if(!this.has(e))throw new Error(`${this.constructor.name}.get() Failed. Name '${e}' not found.`);const t=this.resources[e];if(!t)throw new Error(`${this.constructor.name}.get() Failed. Resource '${t}' not found.`);return t}getAll(){return this.resources}}const S="/assets/BackgroundGeneric01-CvnV8plf.png",A="/assets/Britanic-2j_r9DuK.ttf";class Q extends J{constructor(){super(),this.add(S,new H(S)),this.add(A,new z(A,"Britanic",{filtering:R.Pixel,size:18}))}}const X=new Q,Y={isScrolling:!1,scrollVelocity:o(0,0),imageSource:X.get("BackgroundGeneric01"),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:100,unit:f.Percent},height:{value:100,unit:f.Percent},relativeTo:v.Screen,scaleAspectRatio:b.Ignore},positionLayoutConfiguration:{x:{value:50,unit:f.Percent},y:{value:50,unit:f.Percent},relativeTo:v.Screen}}};class st extends K{constructor(t){t={...Y,...t};super(t);r(this,"_offsetTemp",g.Zero);r(this,"_scrollSprite");r(this,"_scrollVelocity");r(this,"_isScrolling",!1);r(this,"_opacity",1);this._scrollVelocity=this.configuration.scrollVelocity??g.Zero,this._isScrolling=this.configuration.isScrolling??!1,this.z=-1,this.graphics.onPreDraw=this.Graphics_onPreDraw.bind(this)}get configuration(){return this._configuration}get scrollVelocity(){return this._scrollVelocity}set scrollVelocity(t){this._scrollVelocity=t}get opacity(){return this._opacity}set opacity(t){this._opacity=t}async onInitialize(t){this._scrollSprite=this.configuration.imageSource.toSprite(),this._scrollSprite.width=this.layoutEngine.getCalculatedWidth(this.configuration.imageSource),this._scrollSprite.height=this.layoutEngine.getCalculatedHeight(this.configuration.imageSource),this._isScrolling||this.graphics.add(this._scrollSprite)}Graphics_onPreDraw(t,i){if(!this._isScrolling||!this._scrollSprite)return;t.save();const s=this._scrollVelocity.negate();this._offsetTemp=this._offsetTemp.add(s.scale(i/1e3));const a=(c,h)=>(c%h+h)%h;this._offsetTemp=new g(a(this._offsetTemp.x,this.width),a(this._offsetTemp.y,this.height)),t.opacity=this._opacity,t.translate(-this._offsetTemp.x,-this._offsetTemp.y);for(let c=-1;c<=1;c++)for(let h=-1;h<=1;h++)this._scrollSprite.draw(t,c*this.width,h*this.height);t.restore()}}var G=(n=>(n[n.Light=0]="Light",n[n.Medium=1]="Medium",n[n.Heavy=2]="Heavy",n))(G||{});const L={duration:1e3,delay:0};class l{static callAfterDelay(e,t,i){e.actions.delay(t).callMethod(i)}static callAfterFrame(e,t){e.actions.delay(100).callMethod(t)}static async cameraShakeAsync(e,t){switch(t){case 0:e.currentScene.camera.shake(.5,.5,50),e.currentScene.camera.zoom;break;case 1:e.currentScene.camera.shake(5,5,50);break;case 2:e.currentScene.camera.shake(15,15,50);break}}static async awaitNextFrameAsync(){return await l.awaitTimeAsync(999/d.instance.currentFrameElapsedMs)}static async awaitTimeAsync(e){return new Promise(t=>setTimeout(t,e))}static async moveToAsync(e,t,i){i={...L,...i},await l.awaitTimeAsync(i.delay);const s=new u(e,h=>{h.easeTo(t,i.duration)}),a=new u(e,h=>{h.scaleTo(o(1.1,1.1),o(2,2)),h.scaleTo(o(1,1),o(2,2))}),c=new w([s,a]);for(e.actions.runAction(c);!s.isComplete()||!a.isComplete();)await l.awaitNextFrameAsync();return Promise.resolve()}static async scaleUpAndFadeUpAsync(e,t){t={...L,...t},e.scale=o(0,0),e.graphics.opacity=0,await l.awaitTimeAsync(t.delay);const i=new u(e,c=>{c.scaleTo(o(1,1),o(3,3))}),s=new u(e,c=>{c.fade(1,t.duration)}),a=new w([i,s]);for(e.actions.runAction(a);!i.isComplete()||!s.isComplete();)await l.awaitNextFrameAsync();return Promise.resolve()}static async scaleDownAndFadeDownAsync(e,t){t={...L,...t},await l.awaitTimeAsync(t.delay);const i=new u(e,c=>{c.scaleTo(o(0,0),o(2,2))}),s=new u(e,c=>{c.fade(0,t.duration)}),a=new w([i,s]);for(e.actions.runAction(a);!i.isComplete()||!s.isComplete();)await l.awaitNextFrameAsync();return Promise.resolve()}static async scaleUpAndDownAsync(e){const t=new u(e,s=>{s.scaleTo(o(1.2,1.2),o(2,2)),s.scaleTo(o(1,1),o(2,2))}),i=new w([t]);for(await e.actions.runAction(i);!t.isComplete();)await l.awaitNextFrameAsync();return Promise.resolve()}static async scaleDownAndUpAsync(e){const t=new u(e,s=>{s.scaleTo(o(.7,.7),o(4,4)),s.scaleTo(o(1,1),o(4,4))}),i=new w([t]);for(await e.actions.runAction(i);!t.isComplete();)await l.awaitNextFrameAsync();return Promise.resolve()}}class rt{constructor(e){r(this,"onValueChanged");r(this,"_currentValue");r(this,"_previousValue");if(this.onValueChanged=new et,e!==void 0)this._currentValue=e,this._previousValue=e;else throw new Error("Initial value must be provided")}get value(){return this._currentValue}set value(e){e=this.onValueChanging(this._currentValue,e),this._currentValue!==e&&(this._currentValue=e,this.onValueChanged.invoke(this._previousValue,this._currentValue),this._previousValue=this._currentValue)}onValueChanging(e,t){return t}refreshValueChanged(){this.onValueChanged.refresh(this._previousValue,this._currentValue)}}class tt{constructor(){r(this,"listeners",{})}on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(i=>i!==t))}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(i=>i(...t))}}class et{constructor(){r(this,"eventEmitter",new tt);r(this,"eventName","valueChanged")}addEventListener(e){this.eventEmitter.on(this.eventName,e)}removeEventListener(e){this.eventEmitter.off(this.eventName,e)}invoke(e,t){this.eventEmitter.emit(this.eventName,e,t)}refresh(e,t){this.invoke(e,t)}}class ot extends U{constructor(e){super(e)}initializeAsync(){return l.awaitNextFrameAsync()}requireIsInitialized(){if(!this.isInitialized)throw new Error("Error this.isInitialized")}}class at{constructor(){r(this,"_isInitialized",!1)}get isInitialized(){return this._isInitialized}async initializeAsync(){if(this.isInitialized)return Promise.resolve();this._isInitialized=!0}requireIsInitialized(){if(!this.isInitialized)throw new Error("Error this.isInitialized")}}class C extends q{constructor(t){const i=new B({text:"",font:new D({size:20+10/y.RetroFactor,color:E.White,unit:N.Px,family:"Britanic",style:M.Normal,bold:!1,textAlign:_.Left,baseAlign:$.Alphabetic,direction:O.LeftToRight,shadow:{blur:2,offset:o(1,1),color:E.Blue}}),anchor:o(0,0)});i.anchor=o(0,0),i.pos=o(0,0);super();r(this,"_label");r(this,"_layoutEngine");const s={sizeLayoutConfiguration:{width:{value:50,unit:f.Percent},height:{value:4,unit:f.Percent},relativeTo:v.Screen,scaleAspectRatio:b.PrioritizeWidth}};this._layoutEngine=new y(s),this._engine=t,this._label=i}get text(){return this._label.text}set text(t){this._label.text=t}get width(){return this._layoutEngine.getCalculatedWidth()}get height(){return this._layoutEngine.getCalculatedHeight()}onInitialize(){this.addChild(this._label)}anchorToUpperLeft(t){this._label.font.textAlign=_.Left;const i=this.getMarginPercent(t);this.pos=o(i,this.height+i)}anchorToUpperRight(t){this._label.font.textAlign=_.Right;const i=this.getMarginPercent(t);this.pos=o(this._layoutEngine.screenWidthCurrent()-i,this.height+i)}anchorToLowerLeft(t){this._label.font.textAlign=_.Left;const i=this.getMarginPercent(t);this.pos=o(this._label.width/2+i,this._layoutEngine.screenHeightCurrent()-this.height/2-i)}anchorToLowerRight(t){this._label.font.textAlign=_.Right;const i=this.getMarginPercent(t);this.pos=o(this._layoutEngine.screenWidthCurrent()-this._label.width/2-i,this._layoutEngine.screenHeightCurrent()-i)}anchorToCenter(t){this._label.font.textAlign=_.Center,this.getMarginPercent(t),this.pos=o(this._layoutEngine.screenWidthCurrent()/2,this._layoutEngine.screenHeightCurrent()/2-this.height)}getMarginPercent(t){return this._layoutEngine.screenWidthCurrent()*t}}const p=class p extends m{constructor(t){super();r(this,"_textUpperLeft");r(this,"_textUpperRight");r(this,"_textLowerLeft");r(this,"_textCenter");this._textUpperLeft=new C(t),this._textUpperRight=new C(t),this._textLowerLeft=new C(t),this._textCenter=new C(t)}set textUpperLeft(t){this._textUpperLeft.text=t,this._textUpperLeft.anchorToUpperLeft(p.MarginPercent)}set textUpperRight(t){this._textUpperRight.text=t,this._textUpperRight.anchorToUpperRight(p.MarginPercent)}set textLowerLeft(t){this._textLowerLeft.text=t,this._textLowerLeft.anchorToLowerLeft(p.MarginPercent)}set textCenter(t){this._textCenter.text=t,this._textCenter.anchorToCenter(0)}onInitialize(){this.addChild(this._textUpperLeft),this.addChild(this._textUpperRight),this.addChild(this._textLowerLeft),this.addChild(this._textCenter)}};r(p,"MarginPercent",.02);let I=p;class ct extends m{async initializeAsync(){if(this.isInitialized)return Promise.resolve()}requireIsInitialized(){if(!this.isInitialized)throw new Error("Error this.isInitialized")}}class ht{constructor(){r(this,"_isInitialized",!1)}get isInitialized(){return this._isInitialized}async initializeAsync(){if(this.isInitialized)return Promise.resolve();this._isInitialized=!0}requireIsInitialized(){if(!this.isInitialized)throw new Error("Error this.isInitialized")}}class lt{static resizeSpriteWithin(e,t,i){const s=e.width/e.height,a=t/i;let c,h;s>a?(c=t,h=t/s):(h=i,c=i*s);const x=e.clone();return x.width=c,x.height=h,x}}export{K as A,at as B,G as C,d as E,ot as G,y as L,l as M,rt as O,v as R,Q as S,f as U,b as a,ct as b,I as c,ht as d,st as e,lt as f};
