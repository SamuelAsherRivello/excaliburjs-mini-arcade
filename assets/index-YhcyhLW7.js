var ui=Object.defineProperty;var hi=(n,t,e)=>t in n?ui(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var a=(n,t,e)=>hi(n,typeof t!="symbol"?t+"":t,e);import{f as o,u as E,_ as u,v as gi,o as I,w as pi,x as W,h as w,y as L,z as $,b as v,A as wi,B as S,C as Ci,D as mi,g as _i,a as Y,E as Si,F as yi,G as he,H as fi,I as vi}from"./vendor-B7mi3kXY.js";import{S as j,M as h,E as N,U as d,R as g,a as D,A as F,O as K,L as q,C as Bi,B as Pi,b as Ii,c as Di,d as bi,G as Fi,e as Z,f as ii}from"./game-core-ByIoKVKn.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=e(s);fetch(s.href,l)}})();const zi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEhwdrvaJaQAAAlFJREFUWIXtlrGL2lAcxz9nM4QuHhUUpMZFbiyc5JycOrTdDurWv6FIp9sKBbdO5eg/0MXNgkvR5XC4oajoLkJJBCGCQ1rK5SQ0HeyLUZOnp271C+Lj8fI+37zf7/sIHPW/6+RQGzWqFW/Y7pMrnAPw6s37rfY+iIFGteKJ8bDd9+fffvq6cf/YIQwE4eZoAoA5mlDWdW/DI/sb+PzutSfgnfoYLZOkUx9j9VyAjSZ2LsHqsZujiQ+PJ+ZwNauiZZKYowkfa7ehLGUXSHBOKDgv4M9LLxm2+1g9l7Kue9fd7pqJSAPBo12F5ArnS/UOKpVX0DJpPw2DWxNQOCtq0O2urY80IIPkCvN/q+dycZn214jjnv+aOIaDmlUBh059HMrZ2IRWz106XjE2RxPiCdd/UzEH4BgOjuH4Y5lCDYjaR0Fuak0AzooaN7XmEmTx1gvZU8VvzFWFdmajWvEERBxr2MZBiQQAPsyeLir85cf3UNajsMknxq8Pyun8YfvnbwCUUwUtk2TQslFmM1zbRawBGLRs4gmXZy+eMjVtAO7vYlI4SHogWEchkXFxEmKNWKdmVb9c4u1lcJBcRFelordqwJ4q/2KWjOzqeMLdGg6SGGqZJJ3eOsTquVgh8wL8EDhsuIqvSsWle9wxnKXGkmlbA5E9ELyGRfbVrEoqPy9DPOGSys/NrEZsWzhEpADCkyDMDFo293cxlNkM9fGfreIWJelNKEvCxWV6bf1D4VID193uySHjFiVpR8mS8M2o7w2HHT5Iyrru7VPzo446alV/ATMJU0+aN75bAAAAAElFTkSuQmCC",ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEhwmH/1gTQAABJdJREFUaIHtWUFrK1UU/qqzGHSRB4FEgpmglCwEhea9FBdZFZ6VbgbMzo1/QES6cCOC0N1bFHn4B9zUVR9kYenbvFVAaUO7thYlE+ijgSyiFobH+OJi/G7P3LkzudO0ipAPyp2Z3pn5zjnfOffMDbDEEkv8r7Gy6AO+/fyj2er6GgDgw4+/WpHXASAYjeHVK2p+MBoDAB7t9xd+N7CgAYd7OzMAOD86BY3gucTq+pq6dtYPAACPB4P/1oDDvZ0ZSZH8+dEpzvoBmh1PzaPHiXAYquPbMOJGD6DngbS3CUncq1fUuTQAWNyIV4recLi3M3u2/xRAmjxJHvcucHkS4fIkAnAtG5J3Gy7chntz1gKFDKDnN7qbRs/LZC2VI7T9GoCYcDgMMZ04C5E1wdoAKZssyERudrzEORAbNZ04ieh89uDBTI5FYa0/WS7Pj05T5ZHQk5YIhyHchovLkwilcpQ4nk4cNVZbTqESax0BSR6AkXwWcXlM8l69glI5Ss2/PIkKRWNhUR73LtQxNS/BZKXHqy0H4TBEgDhS0vsc3YYLDOzeX7gKmciXyjExXfNAOlLhMMTWto+N7qa6V45AHIVP3nrfKgrWBrB06uSB2ItevZKaA1znBL3PZx3s9lRVkiPn2MLaAHpMT9K78H7br6FUtouClblszEykWON14mf9QOmcmE4c1W6Y7mMOxNG1i4RVBKR3edz2a2j7NWx0N7G17SfmkyBrPVFtOamWgn0TR1NlyoNVvdW7TtMqTGKy78mD7n0J3fjvfvspk2ehKiQjEYzGRqI25HXoUcgzToeVAfJDhfDqlUQ+ZC1s4TA0/k82c2z2OAKwrkbWEaBsstpnHbrG5XX+mWCKQl41KtxKAElPUTIyB4BrD1NqkrRabQ046weYThy1NsyLRKEkBswROO5dqBJoeinLKsFeSF4j8lpuUzLPNYDkn+0/NWpZrsiyp6EUsr7E8ghLZ8hzkwFzJcQEluRX19cSVYi12224yvvBaJyQnS6ZZsfL9LZ+PS8qVqlO2VDLeqlkD8OeX5LN8rxsBLkquw0XG91NfP/lDza0AFgm8affPFGhMyVfqRwpAgT7nTxUW06i3TY9dx5enTvjH6xGr38dTSNE0wjOvevAvbP+Bn49vcJ7H7yJ6e9XivzBbg+//PizmjedOHBfe6nIXj1/CefFC7z9bg33H3bw159/4P7DjvJ+teXAuefg6nl8T9ZqbCUh/QuJFcRtuAhGY9GNxq3GwW4v9QzpzVhWcalknsh8qbYc61bCqox+0e3MKJG8ZX5r21fkZeIxseU6QKOaHQ/HvQu0/Vqios0jTljlwKP9/gpfyiRlFWl2POM+T6kcKa9zEXMbriqzbb+GrW1fkb4JeWsD+ECvXlFelNLx6hWlex1p6SAhHdN7bMkDBbcWs3YLbiIdvbYXIS1R6CY2VabylrWiUuM6bkpYR+FdCbl1Qt3nrah3SR4ouC9UKkeJBiwuddmy0HGbxIlCEXg8GKywkuT1K9WWk5LZXZAHFviBQ//I0Bcf4O5ISyz0At2If4PwrcN2C3CJJZZYwoi/AXILu8sxhDv5AAAAAElFTkSuQmCC",pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAcCAYAAAB75n/uAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEiIIgu52/wAAAphJREFUSInNVkFLG0EYfbsUwpI2SAJig1Aqpbukh8KKJeAlBw146CEIhv4G6S0FL948lAZPnvwFpYL1sF5cE8wloSgGUohkgyQRZNVAlhANSy6ZHsJMZ9ONXUogfafZb3be+94337cs4BFaSidu67FAS+kkNr/KSGPzq8SriDjWTP5FQEvp5DCrYXO6z2Kb030cZjVPpZqsA5r92sw1osk4i0eTcazNXHty4dnB/eml6/pvGCmgpXRSKBTY87N3r1zXhULhUReTccBnH5RC2LudRbleY/vleg17t7MISiEAj7twFdg+2YVlt2DZLRbbuHpwXdP3tk92vTnQUjqR+2EUexUYoukQya4kSHYlwTK17BYM0USxV4HcD7u6EIYDC5FlsjS1yIgN0UTX7uDzi6eIJuO4P71EuV7DxtUD/FIAcj8MYFDKTDuPs4tjB6fDQbXRJKpPYQeCUogRUHIAePNyDgAg98PsPQBQfQqqjabDhciTG8bNn0XkUK7XHJftBsO4cYg84Tcr1dGHf3zTWeaPiVSqNcjyc/YsDmdf7FVcD/KfCio0DHqWdyHSAAA070zQO8i088i08whKIag+BbEv39kEv8/9hOpT2MVm2nkAgzto3pngOVmJ+PJk2nmH0NLUIlQMRCgRJeffo+tKtQbl9dzvElHy9Na6YIgm/FKAdYZfCrB+V30KVJ/C5sMvBQAMOs4vBWCIJtJb6wLPybro08eEAAC5832ha3dg2S3WpnSQ+NblY5bdQtfuIHe+L/BcjhLxOLs4FhABUaGwzCkRzZjuyfbgcocHjMI1SLEQWSZ8zYMf3gIArK8lWHaLdc0ock+oNppEOyqR9M4BG570zgHRjkpkeGpdHRAy3l+cYUz+t+W/F/gFlx9vuXFG0UoAAAAASUVORK5CYII=",we="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAcCAYAAAB75n/uAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AceEiIQkYLuqQAAAc5JREFUSInNlr9rFEEUxz975DCcWUSQPQSJl2JtttgDrUS2SXMcFkkglWyZIn+AaVKnsrNNrYWCe4VYaJ/KwoQsBAe5QyJiEAIuLAtbPItjl7nkTmcgB3nN7JuZ7/u+n8uAhUgUi0Sx2GAWbC6no6HNdQAa1oh5EUgUiyoyVJFhk6a5R2Bcg3Q0RJV5/W0qxhEEnRX8Zgu/2SLorFw9wVxFolgSL5Tei2N5uP1KEi80ngejCAYnR6gyZ28r4NHGY1SZMzg5MnLOiECVOavDr7z9Cbfvdfj25mNd8P+JURf5zRYAX96nANzv3qz3roQAYHc/pfs0AODTy9f0DHHGKdrbCmq9qoMRwcVueH6rM6FLFEvfbfP9QZfNu3B+OqL3bI2+2770y5iGbehTubZ4R/QVmOiW3f2Uz+8OmHY2DZuOhjjHy09m9vOH7Nd4ehddAFSRAUzoqszpu+1ZJsZFrgzBON96h6gyrw1Wq36mE+vYingBYOdcOVV4/o0lDv78YFD8dipDfrMll4wXWY2bhe27bWlU7EB9oBvXPf3X3jSsKjIcDCXxQtFzv352aIQ1HjTdY9MZsJbECyXxQqtXxdxT5IhYOWQt1+fZcm0J/gLZIuNghhtizgAAAABJRU5ErkJggg==",Ce="/assets/Background01-Bfgl5WSZ.png",se="/assets/Background02-C1FDw3ul.png",me="data:image/png;base64,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",_e="/assets/Shoot01-C3uAXra4.wav",Se="/assets/Shoot02-feqa8JwR.wav",f="/assets/Hit01-BScFQpPY.wav",ye="/assets/Hit02-D7Q-SvHj.wav",B=new j;B.add("Asteroid01",new o(zi));B.add(ge,new o(ge));B.add(pe,new o(pe));B.add(we,new o(we));B.add(Ce,new o(Ce));B.add(se,new o(se));B.add(me,new o(me));B.add(_e,new E(_e));B.add(Se,new E(Se));B.add(f,new E(f));B.add(ye,new E(ye));const V=B;class si{static setPositionWrapAroundScreen(t,e,i){const s=t.anchor.x*t.width,l=t.anchor.y*t.height;if(i){let c=t.pos.x,A=t.pos.y;t.pos.x-s+t.width<0?c=e.drawWidth+s:t.pos.x-s>e.drawWidth&&(c=-t.width+s),t.pos.y-l+t.height<0?A=e.drawHeight+l:t.pos.y-l>e.drawHeight&&(A=-t.height+l),t.pos!=new u(c,A)&&(t.pos=new u(c,A))}else{let c=t.pos.x,A=t.pos.y;t.pos.x-s<0?c=e.drawWidth+s:t.pos.x-s>e.drawWidth&&(c=-s),t.pos.y-l<0?A=e.drawHeight+l:t.pos.y-l>e.drawHeight&&(A=-l),t.pos=new u(c,A)}}}const Ei={duration:1e3,delay:0,directionRadians:0};class O{static async particlesAddDustAsync(t,e){e={...Ei,...e};const i=new gi({});return i.pos=t.pos,i.radius=5,i.emitRate=300,i.particleLife=100,i.color=I.White,i.opacity=.2,i.emitterType=pi.Circle,i.minSize=5,i.maxSize=20,i.minVel=50,i.maxVel=100,i.minAngle=0,i.maxAngle=Math.PI,i.fadeFlag=!0,i.isEmitting=!0,O.getParticleParent().add(i),await h.awaitTimeAsync(e.duration),i.kill(),Promise.resolve()}static getParticleParent(){return N.instance}}const fe={pos:new u(100,100),velocity:new u(5,5),onAddedCallback:n=>{},generation:3,imageSource:V.get("Asteroid01"),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:30,unit:d.Percent},height:{value:30,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeWidth}}},P=class P extends F{constructor(e){e={...fe,...e};super(e);a(this,"RotationSpeed",Math.random()*.001-.003);a(this,"_isDestroying",!1);a(this,"_generation");a(this,"_health",new K(P.HealthInitial));a(this,"_onAddedCallback");this.pos=e.pos,this.vel=e.velocity,this._generation=e.generation,this.body.useGravity=!1,this._onAddedCallback=e.onAddedCallback,this._onAddedCallback(this),this._health.onValueChanged.addEventListener(this.health_onValueChanged.bind(this))}get configuration(){return this._configuration}get health(){return this._health}get generation(){return this._generation}get isDestroying(){return this._isDestroying}static createAndAdd(e,i,s,l,c){for(let A=0;A<i;A++){const M=c||new u(Math.random()*e.drawWidth,Math.random()*e.drawHeight),H=new u(Math.random()*100-50,Math.random()*100-50),m=fe;m.pos=M,m.velocity=H,m.generation=s,m.onAddedCallback=l;const G=new P(m);G.name="Asteroid",e.add(G)}}async onInitialize(e){const i=this.configuration.imageSource.toSprite(),s=this._generation/P.AsteroidMaxGeneration;i.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource).scale(s),this.graphics.use(i);const l=.5;this.collider.set(new W({radius:Math.max(i.width/2,i.height/2)*l})),this.actions.clearActions(),await h.scaleUpAndFadeUpAsync(this)}onPreUpdate(e,i){this.rotation+=this.RotationSpeed,this.setPositionWrapAroundScreen(e)}setPositionWrapAroundScreen(e){si.setPositionWrapAroundScreen(this,e,!0)}async destroy(){this._isDestroying=!0,this.vel=w(0,0),this.collider.clear(),this._generation>1&&Math.round(Math.random()*2)===1&&P.createAndAdd(N.instance,3,this._generation-1,this._onAddedCallback,this.pos),this.actions.clearActions(),O.particlesAddDustAsync(this,{duration:100}),await h.scaleDownAndFadeDownAsync(this,{duration:100}),this.onDestroyComplete()}health_onValueChanged(e,i){i<=0&&this.destroy()}onDestroyComplete(){this.kill()}};a(P,"AsteroidMaxGeneration",3),a(P,"AsteroidCountInitial",3),a(P,"HealthInitial",100),a(P,"HealthDelta",P.HealthInitial);let T=P;const xi=L.create("player"),ai=L.create("bullet"),oi=L.create("asteroid"),Hi=$.collidesWith([]),Gi=$.collidesWith([oi]),Vi=$.collidesWith([ai]),ee={Player:Hi,Bullet:Gi,Asteroid:Vi,PlayerGroup:xi,BulletGroup:ai,AsteroidGroup:oi},ni={imageSource:V.get("Bullet01"),collisionGroup:ee.Bullet,collisionType:v.Active,layoutConfiguration:{sizeLayoutConfiguration:{width:{value:20,unit:d.Percent},height:{value:20,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeWidth}}};class ri extends F{constructor(e){e={...ni,...e};super(e);a(this,"_lifespan",1e3);a(this,"_isDestroying",!1);this.vel=e.vel??w(0,0),this.body.useGravity=!1}get configuration(){return this._configuration}get isDestroying(){return this._isDestroying}async onInitialize(e){const i=this.configuration.imageSource.toSprite();i.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.use(i);const s=.25;this.collider.set(new W({radius:Math.max(i.width/2,i.height/2)*s})),this.rotation=Math.atan2(this.vel.y,this.vel.x),this.on("collisionstart",l=>{l.other instanceof T&&(this._isDestroying||(l.other.health.value-=T.HealthDelta,this.destroy()))}),e.clock.schedule(()=>{this.onDestroyComplete()},this._lifespan),this.actions.clearActions(),await h.scaleUpAndFadeUpAsync(this,{duration:100})}async destroy(){this._isDestroying=!0,this.vel.scale(.1),this.collider.clear(),V.get("Hit02").play(),this.actions.clearActions(),await h.scaleDownAndFadeDownAsync(this,{duration:100}),this.onDestroyComplete()}async onDestroyComplete(){this.isKilled||this.kill()}}a(ri,"Speed",500);const le={imageSource:V.get("Ship01"),collisionGroup:ee.Player,collisionType:v.Active,layoutConfiguration:{sizeLayoutConfiguration:{width:{value:15,unit:d.Percent},height:{value:15,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeWidth},positionLayoutConfiguration:{x:{value:50,unit:d.Percent},y:{value:50,unit:d.Percent},relativeTo:g.Screen}}};class ki extends F{constructor(e=le){e={...le,...e};super(e);a(this,"MaxRotationSpeed",.05);a(this,"RotationAcceleration",5e-4);a(this,"RotationDeceleration",.001);a(this,"ThrustForce",200/q.RetroFactor);a(this,"MaxSpeed",300/q.RetroFactor);a(this,"DragCoefficient",.01);a(this,"BulletSpeed",800);a(this,"_currentRotationSpeed",0);a(this,"_rotationHoldTime",0);a(this,"_canShoot",!0);a(this,"_shootCooldown",250)}get configuration(){return this._configuration}onInitialize(){const e=this.configuration.imageSource.toSprite();e.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.add(e),this.collider.set(new W({radius:Math.max(e.width/2,e.height/2)}))}onPreUpdate(e,i){this.applyDrag(i),this.setPositionWrapAroundScreen(e),this.updateShootCooldown(i)}rotate(e,i,s){s!==0?(this._rotationHoldTime+=i,this._currentRotationSpeed+=this.RotationAcceleration*i*s):(this._rotationHoldTime=0,this._currentRotationSpeed>0?this._currentRotationSpeed=Math.max(0,this._currentRotationSpeed-this.RotationDeceleration*i):this._currentRotationSpeed<0&&(this._currentRotationSpeed=Math.min(0,this._currentRotationSpeed+this.RotationDeceleration*i)));const l=Math.min(this.MaxRotationSpeed,this._rotationHoldTime/500*this.MaxRotationSpeed);this._currentRotationSpeed=wi(this._currentRotationSpeed,-l,l),this.rotation+=this._currentRotationSpeed}move(e,i){const s=w(Math.sin(this.rotation)*this.ThrustForce,-Math.cos(this.rotation)*this.ThrustForce);this.vel=this.vel.add(s.scale(i/1e3)),this.vel.size>this.MaxSpeed&&(this.vel=this.vel.normalize().scale(this.MaxSpeed))}async shoot(e,i){if(!this._canShoot)return;this._canShoot=!1,this._shootCooldown=250;const s=w(Math.sin(this.rotation)*this.BulletSpeed,-Math.cos(this.rotation)*this.BulletSpeed),l=this.pos.add(s.normalize().scale(this.width/2)),c=ni;c.pos=l,c.vel=s;const A=new ri(c);A.z=this.z-1,e.add(A),this.actions.clearActions(),await h.cameraShakeAsync(e,Bi.Light),V.get("Shoot01").play()}applyDrag(e){const i=this.vel.negate().scale(this.DragCoefficient*this.vel.size);this.vel=this.vel.add(i.scale(e/1e3))}setPositionWrapAroundScreen(e){si.setPositionWrapAroundScreen(this,e,!0)}updateShootCooldown(e){this._canShoot||(this._shootCooldown-=e,this._shootCooldown<=0&&(this._canShoot=!0))}}var p=(n=>(n[n.None=0]="None",n[n.GameInitialized=1]="GameInitialized",n[n.GameRunning=2]="GameRunning",n[n.GameEnded=3]="GameEnded",n))(p||{});class Qi extends Pi{constructor(){super(...arguments);a(this,"_score",new K(0));a(this,"_lives",new K(0));a(this,"_gameState",new K(0))}get score(){return this._score}get lives(){return this._lives}get gameState(){return this._gameState}async initializeAsync(){await super.initializeAsync(),this._score.value=-1,this._lives.value=-1,this._score.refreshValueChanged(),this._lives.refreshValueChanged()}}class Mi extends Ii{constructor(e){super();a(this,"_ui");this._ui=new Di(e)}set score(e){const i=e.toString().padStart(3,"0");this._ui.textUpperLeft=`Score: ${i}​`}set lives(e){e=Math.max(0,e);const i="❤️",s="🖤",l=3,c=i.repeat(e),A=s.repeat(Math.max(0,l-e)),M=c+A;this._ui.textUpperRight=`Lives: ${M}`}set buttons(e){this._ui.textLowerLeft=e}set status(e){this._ui.textCenter=e}async initializeAsync(){super.initializeAsync(),this.buttons="⬅️⬆️​​➡️​🟦​, F, R​",this.status=""}onInitialize(){this.addChild(this._ui)}}class Ri{constructor(){a(this,"_lastPointerDownTime",0);a(this,"_isPointerDown",!1);a(this,"_isPointerDoubleClick",!1);a(this,"actions");this.actions={left:{wasPressed:!1,isHeld:!1,wasReleased:!1},down:{wasPressed:!1,isHeld:!1,wasReleased:!1},right:{wasPressed:!1,isHeld:!1,wasReleased:!1},up:{wasPressed:!1,isHeld:!1,wasReleased:!1},action:{wasPressed:!1,isHeld:!1,wasReleased:!1},fullScreen:{wasPressed:!1,isHeld:!1,wasReleased:!1},resetGame:{wasPressed:!1,isHeld:!1,wasReleased:!1}},N.instance.input.pointers.primary.on("down",()=>{const t=Date.now();t-this._lastPointerDownTime<150&&(this._isPointerDoubleClick=!0),this._lastPointerDownTime=t,this._isPointerDown=!0}),N.instance.input.pointers.primary.on("up",()=>{this._isPointerDown=!1})}update(t,e){this.updateAction(t,"left",[S.A,S.Left]),this.updateAction(t,"right",[S.D,S.Right]),this.updateAction(t,"up",[S.W,S.Up]),this.updateAction(t,"down",[S.S,S.Down]),this.updateAction(t,"action",[S.Space,S.Enter]),this.updateAction(t,"fullScreen",[S.F]),this.updateAction(t,"resetGame",[S.R]),this.actions.action.isHeld=this.actions.action.wasPressed||this._isPointerDown,this.actions.action.wasPressed=this.actions.action.wasPressed||this._isPointerDown,this.actions.fullScreen.wasPressed=this.actions.fullScreen.wasPressed,this._isPointerDoubleClick=!1,this._isPointerDown=!1}updateAction(t,e,i){const s=t.input.keyboard;this.actions[e]={wasPressed:i.some(l=>s.wasPressed(l)),isHeld:i.some(l=>s.isHeld(l)),wasReleased:i.some(l=>s.wasReleased(l))}}}class Ui extends bi{constructor(){super();a(this,"input");this.input=new Ri}update(e,i){this.input.update(e,i)}get left(){return this.input.actions.left}get right(){return this.input.actions.right}get up(){return this.input.actions.up}get down(){return this.input.actions.down}get action(){return this.input.actions.action}get fullScreen(){return this.input.actions.fullScreen}get resetGame(){return this.input.actions.resetGame}}class J extends Fi{constructor(){console.log("retroFactor",q.RetroFactor);const e={canvasElementId:"excaliburjs-game-canvas",width:900/q.RetroFactor,height:1600/q.RetroFactor,displayMode:Ci.FitContainer,maxFps:120,physics:{enabled:!0,solver:mi.Realistic,gravity:w(0,800)},antialiasing:{pixelArtSampler:!0,nativeContextAntialiasing:!1,multiSampleAntialiasing:!0,filtering:_i.Pixel,canvasImageRendering:"auto"},suppressPlayButton:!0};super(e);a(this,"_view");a(this,"_model");a(this,"_controller")}get model(){return this._model}get view(){return this._view}get controller(){return this._controller}async initializeAsync(){await super.initializeAsync(),this._view=new Mi(this),await this._view.initializeAsync(),this.currentScene.add(this._view),this._controller=new Ui,await this._controller.initializeAsync(),this._model=new Qi,await this._model.initializeAsync(),this._model.score.onValueChanged.addEventListener(this.model_Score_onValueChanged.bind(this)),this._model.lives.onValueChanged.addEventListener(this.model_Lives_onValueChanged.bind(this)),this._model.gameState.onValueChanged.addEventListener(this.model_GameState_onValueChanged.bind(this))}onPreUpdate(e,i){super.onPreUpdate(e,i),this.controller.update(e,i),this.controller.fullScreen.wasPressed&&(e.screen.isFullScreen?e.screen.exitFullScreen():e.screen.goFullScreen()),this.controller.resetGame.wasPressed&&location.reload()}onModelChanged(){}model_Score_onValueChanged(e,i){this._view.score=i,this.onModelChanged()}model_Lives_onValueChanged(e,i){this._view.lives=i,this.onModelChanged()}model_GameState_onValueChanged(e,i){this.onModelChanged()}}class Ti extends J{constructor(){super();a(this,"_background");a(this,"_player");a(this,"_asteroidCount",new K(0))}async initializeAsync(){if(this.isInitialized)return Promise.resolve();await V.initializeAsync(),this.start(V.loader),await super.initializeAsync(),this.initializeBackgrounds(),this.initializePlayer(),this.initializeAsteroids(),this._asteroidCount.onValueChanged.addEventListener(this.onModelChanged.bind(this)),this.model.score.value=0,this.model.lives.value=3,this.model.gameState.value=p.GameInitialized}initializeBackgrounds(){const e={imageSource:V.get("Background02"),isScrolling:!0,scrollVelocity:w(15,30)};this._background=new Z(e),this.currentScene.add(this._background)}initializePlayer(){this._player=new ki(le),this.currentScene.add(this._player)}initializeAsteroids(){T.createAndAdd(this,T.AsteroidCountInitial,T.AsteroidMaxGeneration,this.asteroid_onCreate.bind(this))}handlePlayerInput(e,i){this._player&&(this.controller.left.isHeld?this._player.rotate(e,i,-1):this.controller.right.isHeld?this._player.rotate(e,i,1):this._player.rotate(e,i,0),this.controller.up.isHeld&&this._player.move(e,i),this.controller.action.wasPressed&&this._player.shoot(e,i))}onPreUpdate(e,i){super.onPreUpdate(e,i),this.handlePlayerInput(e,i)}onModelChanged(){this.model.gameState.value===p.GameInitialized&&(console.log(`GameState: ${p[this.model.gameState.value]}`),this.model.gameState.value=p.GameRunning,console.log(`GameState: ${p[this.model.gameState.value]}`)),this.model.gameState.value===p.GameRunning&&(this.model.lives.value==0&&(console.log("No Lives"),this.model.gameState.value=p.GameEnded,console.log(`GameState: ${p[this.model.gameState.value]}`)),this._asteroidCount.value==0&&(console.log("No Asteroids"),this.model.gameState.value=p.GameEnded,console.log(`GameState: ${p[this.model.gameState.value]}`))),this.model.gameState.value,p.GameEnded}asteroid_onCreate(e){this._asteroidCount.value++,e.on("postkill",()=>{this._asteroidCount.value--,this.model.score.value+=10*e.generation})}}const ve="/assets/Paddle01-CBu270WY.png",Be="/assets/Ball01-Cy8AXPTx.png",Pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAACACAYAAAACsL4LAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0YTE3OTkxNC1jN2VmLTRlYTItYWQ1NS1jYjc0MTkzYzIyY2UiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REMwQjI1NDQwNDM3MTFFOEFENUFDMDQzRTI1ODgzQjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REMwQjI1NDMwNDM3MTFFOEFENUFDMDQzRTI1ODgzQjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YjUyNjVkOTEtOTNjNi00YjNiLWJiYzQtMTM4MWUxMGM4NjVmIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjRhMTc5OTE0LWM3ZWYtNGVhMi1hZDU1LWNiNzQxOTNjMjJjZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pn7PIh8AAANESURBVHja7NhPThNRAMfxOpYmLFy4U5d6glkQDQuv4BG8ikfxKGwUSaODhaUCWrUNgSIhgKEipiaaGP902s40fe99Pqu2m5d5k/y+Sa89frL26t6tG3kDgGQ8XWsX2eHpRf62f1K4DoB0xn9ncJxnoy8iAJDW+I8+Zz9/FAGAdMb/twCIAEA64/9HAEQAII3x/2sARAAg/vH/ZwBEACDu8f9vAEQAIN7xHxsAEQCIc/xLBUAEAOIb/9IBEAGAuMZ/ogCIAEA84z9xAEQAII7xnyoAIgAQ/vhPHQARAAh7/GcKgAgAhDv+MwdABADCHP9KAiACAOGNf2UBEAGAsMa/0gCIAEA44195AEQAIIzxryUAIgCw+ONfWwBEAGCxx7/WAIgAwOKO/0iz7ocYRWCwM3h+/vVyySsFGO/Nfm+4Nzherfuc5jweZvvz2dLu6cWK1wpQwtmwPY9jMjcNkCYBABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABABAAVwAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgAgAAAIAAACAEC8mnM55fxo2Dg8aLtugBK+XQ6jCEDvoF/sbq2vNq6uvFSAsm7eKRqt5bzOI2r9C2g0/i+LZ7nxB5jQ0ae8cXFeBBkA4w+w2BGoJQDGH2DxI1B5AIw/QBgRqDQAxh8gnAhUFgDjDxBWBCoJgPEHCC8CMwfA+AOEGYGZAmD8AcKNwNQBMP4AYUdgqgAYf4DwIzBxAIw/QBwRmCgAxh8gngiUDoDxB4grAqUC8GH/Y9v4A8QVgbEB6Pa7LzY311eMP0BcEcjGjf/rzsYDtwkQXwQy4w+QZgQy4w+QZgQy4w+QZgQy4w+QZgR+BeB9v7th/AHSicCPAOz13hWdzsZ9twOQTgSut+4+fLS91c7dCkAivpzcbrSWi+8CDACKd319HqexWAAAAABJRU5ErkJggg==",Ie="/assets/Tile02-TTYuOWn4.png",De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAACACAYAAAACsL4LAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0YTE3OTkxNC1jN2VmLTRlYTItYWQ1NS1jYjc0MTkzYzIyY2UiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RDEzMEYzNjMwNDM3MTFFOEFENUFDMDQzRTI1ODgzQjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RDEzMEYzNjIwNDM3MTFFOEFENUFDMDQzRTI1ODgzQjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YjUyNjVkOTEtOTNjNi00YjNiLWJiYzQtMTM4MWUxMGM4NjVmIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjRhMTc5OTE0LWM3ZWYtNGVhMi1hZDU1LWNiNzQxOTNjMjJjZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ppb+0VkAAAM6SURBVHja7NjNahNRAIZhHdJFETeu3Og9zKIovTfvyJUXoDXFokQ7itCd0iatSpXSEDWExEanICL+TH5mQs45z7NKsjnMGfheyNUHB/f2b2zezq8AkIyHL+4X2dfJeX427BauAyCd8T/tn+ZZ+UUEANIa//Jz9vNHEQBIZ/x/C4AIAKQz/n8EQAQA0hj/vwZABADiH/9/BkAEAOIe//8GQAQA4h3/ygCIAECc4z9TAEQAIL7xnzkAIgAQ1/jPFQARAIhn/OcOgAgAxDH+CwVABADCH/+FAyACAGGP/1IBEAGAcMd/6QCIAECY419LAEQAILzxry0AIgAQ1vjXGgARAAhn/GsPgAgAhDH+jQRABADWf/wbC4AIAKz3+DcaABEAWN/xL7WafogyAsNBf+/bxWjDKwWo1jvpjn+M/3bT57RW8TDno97GYHy25bUCVPt8Meqs4pzMVQOkSQAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAAEAAABAAAAQBAAAAQAAAEAAABAEAAABAAAAQAAAEAQAAABMAVAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAACAAAAgAAAIAgAAAIAAACAAAAgCAAAAgAAAIAAACAIAAAAgAAAIAgAAAEK/WKg7pfxyN330adFw3QLXJeDqOIgAnx++L9s7B9nTqpQLM6uat68XmtVbe5BmN/gVUjv+jnee58QeYz4feIB9+mRRBBsD4A6x3BBoJgPEHWP8I1B4A4w8QRgRqDYDxBwgnArUFwPgDhBWBWgJg/AHCi8DSATD+AGFGYKkAGH+AcCOwcACMP0DYEVgoAMYfIPwIzB0A4w8QRwTmCoDxB4gnAjMHwPgDxBWBmQLQPTruGH+AuCJQGYCjw97Tx+1iy/gDxBWBrGr827sv77pOgPgikBl/gDQjkBl/gDQjkBl/gDQjkBl/gDQjkP0a/+4z4w+QTgQuA/D2zWHR3n11x/UApBOBrBz/J3uvc9cCkFYEvgswAG3dtFXNRSXJAAAAAElFTkSuQmCC",Q=new j;Q.add(ve,new o(ve));Q.add(Be,new o(Be));Q.add(Pe,new o(Pe));Q.add(Ie,new o(Ie));Q.add(De,new o(De));Q.add(se,new o(se));Q.add(f,new E(f));const _=Q;class Ni extends Y{constructor(){super({collisionType:v.Active,collisionGroup:ee.Player});a(this,"_moveSpeed",100);a(this,"shadowVisible",!0);a(this,"_shadowTintCache");a(this,"_shadowTint",new I(0,0,0,.2));a(this,"_shadowOffset",w(3,3));a(this,"_flipHorizontal",!1)}onInitialize(){let e=_.get("Paddle01").toSprite();e=ii.resizeSpriteWithin(e,100,50),this.graphics.use(e),this.collider.set(new W({radius:Math.max(e.width,e.height)/2})),this.graphics.onPreDraw=i=>{if(!(!this.shadowVisible||!this.graphics)){this._shadowTintCache=i.tint,i.tint=this._shadowTint;for(const s of Object.values(this.graphics.graphics))s.draw(i,-s.width*this.anchor.x+this._shadowOffset.x,-s.height*this.anchor.y+this._shadowOffset.y);i.tint=this._shadowTintCache}}}async move(e,i,s){s=s.scale(this._moveSpeed*(i/1e3)),this.pos=this.pos.add(s),s.x!==0&&(this._flipHorizontal=s.x>0,this.graphics.flipHorizontal=this._flipHorizontal),await h.scaleDownAndUpAsync(this),await h.awaitTimeAsync(200)}}const Wi={imageSource:_.get("Tile01"),anchor:w(.5,.5),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:10,unit:d.Percent},height:{value:10,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeWidth}}};class Li extends F{constructor(t){t={...Wi,...t},super(t),this.on("pointerup",e=>{console.log("click me: "+this.pos.x),this.kill()})}onInitialize(){const t=this._configuration.imageSource.toSprite();t.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.add(t)}onPreUpdate(t,e){}}class Yi extends Y{constructor(t){super({width:t.width,height:t.height,collisionType:v.PreventCollision})}onInitialize(t){this.addTiles(t)}addTiles(t){const e=[_.get("Tile01"),_.get("Tile02"),_.get("Tile03")],i=t.screen.drawWidth,s=t.screen.drawHeight,l=.3,c=i*l,A=i*(1-l),M=s*.2,H=s*.5;let m=c,G=M,R,re=0;for(;G<=H;){for(;m<=A;){re=re+1;const Ai=e[Math.floor(Math.random()*e.length)];R=new Li({imageSource:Ai}),R.pos=new u(m,G),this.addChild(R),m+=R.width;const ue=R;R.graphics.opacity=0,h.callAfterFrame(ue,this.tileEntrance.bind(this,ue,re))}m=c,G+=R.width/(384/128)}}async tileEntrance(t,e){await h.scaleUpAndFadeUpAsync(t,{duration:100,delay:3*e})}}class ji extends J{constructor(){super();a(this,"_player");a(this,"_background");a(this,"_tileLevel")}async initializeAsync(){if(this.isInitialized)return Promise.resolve();await _.initializeAsync(),this.start(_.loader),await super.initializeAsync(),this.initializeBackground(),this.initializeLevel(),this.initializePlayer(),this.model.score.value=0,this.model.lives.value=3}onPreUpdate(e,i){super.onPreUpdate(e,i),this.handlePlayerInput(e,i)}initializeBackground(){this._background=new Z({imageSource:_.get("Background02")}),this.currentScene.add(this._background)}initializeLevel(){this._tileLevel=new Yi({width:this.screen.resolution.width,height:this.screen.resolution.height}),this.currentScene.add(this._tileLevel)}initializePlayer(){this._player=new Ni,this._player.pos.x=this.screen.resolution.width/2,this._player.pos.y=this.screen.resolution.height-100,this.currentScene.add(this._player)}handlePlayerInput(e,i){(this.controller.left.wasPressed||this.controller.right.wasPressed)&&_.get("Hit01").play(),(this.controller.left.wasReleased||this.controller.right.wasReleased)&&_.get("Hit01").play(),this.controller.left.isHeld?(this._player.move(e,i,new u(-1,0)),this.model.score.value+=1):this.controller.right.isHeld&&(this._player.move(e,i,new u(1,0)),this.model.score.value+=1),this.controller.action.wasPressed&&_.get("Hit01").play()}onModelChanged(){this.model.lives.value==0&&console.log("Gameover")}}const be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAoklEQVQ4jc1TQQ7EIAiEzX6j9rifqK/XV+yN+pDZg8Gicmm7h05CUnBmAE0ZAN3B65b67wYhc9tHhBEyQ6SGx+kMOjF/EQtRWmoeS6153Gawb2D9jukzjWprlvseiSEztLNC83F8IiL2nlGEuxUU63p0difQDqNwPLcrTM+4b2DtHstRj6UXTgZ2P2viibu7ANBiSQSbezFy3Es8g4f9C1fwA9GJfV3fn7FiAAAAAElFTkSuQmCC",Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAnElEQVQ4jaVSQQ7DIAxz+o9x3SfG68srdmM8JDuwVDQ4a6taQoLgOIlBVBV3sNzK9gKpyGE7nrNEF7WKpiJaa1+RyCbwealsyfLW3ID10c+59RjjUg/y+jwVAwDxr5CKqFWeRNq+Ou3ACLnNAj6ZClwF9+Bn4NgF6wgIPLD9+AoGP8ZOwJLZrNF9aCLDXxPPfGPGpT/xCCN3MvEqvupKWbVfQ8RDAAAAAElFTkSuQmCCgg==",ze="/assets/Log01-nrKP4HGl.png",Ee="/assets/Log02-Q2NTdCyC.png",xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAfklEQVQ4ja1T2w2AIAxsDXuUP4dyHkdxKP7KJOeHkaiVR6yXEJo+KHcUBkAehNHEzGw6CcChl9A7eBq9QRUAbmulhKevFedTxJwthRZEDnoMwBRvMRV70dn4rmBV6hZTJCK1uwjYLaKfglfEH5+xM4m1uFvE8hdG5v4NhcJX7BjupQH5j5UMAAAAAElFTkSuQmCC",He="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAArklEQVQ4jcVTyw2DMAx9Rl2j9EaWSBdhQBaJlwinlgzyeqgcXAQXglRLluPEn5dnWUiiRbqmbCvwFqHqzD27TVCdaQoAtzNd78+ABykAIMZBr8Ilfi+3fq8rkgm5FopxkFrAIB1JjINYnEfQHSWPCBgR6tlLSRm7HPjACbn6HvaWg+Yx/iDwnTyaEQEL1l+WlFF05iUkNo8RJJFS5gvgniUJr/Zm/ikS/Rjl79v4AR6hq/qCtSesAAAAAElFTkSuQmCC",Ge="/assets/Background01-BiUEPgXf.png",x=new j;x.add(be,new o(be));x.add(Fe,new o(Fe));x.add(xe,new o(xe));x.add(He,new o(He));x.add(ze,new o(ze));x.add(Ee,new o(Ee));x.add(Ge,new o(Ge));x.add(f,new E(f));const C=x,oe=class oe extends Y{constructor(){super({pos:w(150,150),width:50,height:50,collisionType:v.Active,collisionGroup:ee.Player})}onInitialize(){const t=C.get("FrogIdle01").toSprite(),e=C.get("FrogJump01").toSprite();t.scale=w(2,2),e.scale=w(2,2),this.graphics.add("idle",t),this.graphics.add("jump",e),this.graphics.use("idle"),this.collider.set(new W({radius:Math.max(t.width,t.height)/2}))}async move(t,e,i){this.pos=this.pos.add(i.scale(oe.DistancePerJump)),this.rotation=i.toAngle()+Math.PI/2,this.graphics.use("jump"),await h.scaleUpAndDownAsync(this),await h.awaitTimeAsync(200),this.graphics.use("idle")}};a(oe,"DistancePerJump",40);let ae=oe;class Zi extends Y{constructor(e){super({width:e.width,height:e.height,pos:e.pos,color:new I(100,20,20,1),collisionType:v.Active});a(this,"direction");a(this,"speed");a(this,"_imageSource");a(this,"laneWidth");this.direction=e.direction,this._imageSource=e.imageSource,this.speed=e.speed,this.laneWidth=e.laneWidth}onInitialize(e){let i=this._imageSource.toSprite();i=ii.resizeSpriteWithin(i,this.width,this.height),this.graphics.use(i)}onPreUpdate(e,i){this.pos.x+=this.direction*this.speed*i/1e3;const s=this.width+100;this.direction>0?this.pos.x>this.laneWidth+s&&(this.pos.x=-this.width-s):this.pos.x<-this.width-s&&(this.pos.x=this.laneWidth+s)}}class Ve extends Y{constructor(e){super({width:e.width,height:e.height,pos:e.pos,color:e.color,collisionType:v.PreventCollision});a(this,"_imageSource");this._imageSource=e.imageSource}onInitialize(e){const l=this.height,c=this.width/3,A=Math.random()>.5?1:-1,M=Math.random()*50+50;for(let H=0;H<3;H++){if(Math.random()>.8)continue;let m;A>0?m=H*c-this.width:m=H*c;const G=new Zi({width:80,height:l,imageSource:this._imageSource,pos:w(m,0),direction:A,speed:M,laneWidth:this.width});this.addChild(G)}}}class Oi extends Y{constructor(e){super({width:e.width,height:e.height,collisionType:v.PreventCollision});a(this,"_distanceGapY",ae.DistancePerJump)}onInitialize(e){this.addCars(),this.addLogs()}addCars(){const e=this.height-360;[C.get("Car01"),C.get("Car02")].forEach((s,l)=>{{const c=new Ve({imageSource:s,width:this.width,height:this._distanceGapY,color:new I(100,100,100,.3),pos:w(0,e-2*this._distanceGapY*l)});this.addChild(c)}})}addLogs(){const e=this.height-560;[C.get("Log01"),C.get("Log02"),C.get("Log01"),C.get("Log01"),C.get("Log02")].forEach((s,l)=>{{const c=new Ve({imageSource:s,width:this.width,height:this._distanceGapY,color:new I(100,100,100,.3),pos:w(0,e-this._distanceGapY*l)});this.addChild(c)}})}}class Ji extends J{constructor(){super();a(this,"_player");a(this,"_background");a(this,"_level")}async initializeAsync(){if(this.isInitialized)return Promise.resolve();await C.initializeAsync(),this.start(C.loader),await super.initializeAsync(),this.initializeBackground(),this.initializeLevel(),this.initializePlayer(),this.model.score.value=0,this.model.lives.value=3}initializeBackground(){this._background=new Z({imageSource:C.get("Background01")}),this.currentScene.add(this._background)}initializeLevel(){this._level=new Oi({width:this.screen.resolution.width,height:this.screen.resolution.height}),this._level.pos.x=this.screen.resolution.width/2,this._level.pos.y=this.screen.resolution.height/2,this.currentScene.add(this._level)}initializePlayer(){this._player=new ae,this._player.pos.x=this.screen.resolution.width/2,this._player.pos.y=this.screen.resolution.height-50,this.currentScene.add(this._player),this._player.z=1e4}handlePlayerInput(e,i){this.controller.left.wasPressed?(this._player.move(e,i,new u(-1,0)),C.get("Hit01").play()):this.controller.right.wasPressed?(this._player.move(e,i,new u(1,0)),C.get("Hit01").play()):this.controller.up.wasPressed?(this._player.move(e,i,new u(0,-1)),C.get("Hit01").play()):this.controller.down.wasPressed&&(this._player.move(e,i,new u(0,1)),C.get("Hit01").play()),this.controller.action.wasPressed}onPreUpdate(e,i){super.onPreUpdate(e,i),this.handlePlayerInput(e,i)}onModelChanged(){this.model.lives.value==0&&console.log("Gameover")}}const ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AgCARwsedfrjAAAA9xJREFUeJzt2V9oW2UYx/HvmXW1IkxZUSjiahsXNmi2KpXsZhc6uosV2Y0IuqkXDhSxQzuH4HS4ooKjG7Qwxc5O3dzFCnZKiyhzeNdCYfaPOoNJCZZ1ZcaLUUaNc329iOeQNOlKa+x5X/x9IOSc9zTlyfPk/XcOiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiI67ywA1jMpY5HuX75mslv8x7c6K17sieskMpqVdgB3Ey6Y3tR8gHMhZ/Mi81bwwip7KztAdMdzVw3hhvTM2ZqNAPAUDoLwMXHXqUhFgXgpaeb8TzP2u+xGGt7wJ9zhcn35Se/KRZhaGQCY4yZS/SFEea/Zm0BsqZw5BlKZ4uSH1wbmcBbv7NoqHKBtQV4YP+54NhP/s34PeG/jqvcrC1Ael/cuWQuh7UFAJgazQQT73wt2x4ueu/69JsVi61crC1Ae282WNm88stkcDw+lgj+ZngsucJRlZ+1BTDGK/j1d3e0FhTh4JHTwTWXC2Ht+vnZdY3EVmdM/q8fYE9bZzA3+CsiX+sz2639Pguxtgd4c6VzOb8n+C8Xkw9QEXYAC2m47TcDcHdVHVdmJwqubfjyMADx2koAajZV073C8ZWLtQUYz671/jKruDJ7IWj76N13uFbzkAE42zsAiT7itZVMjWZI74ubDUeS3uxcZsH/aSNrC3Di15GC821PvMVQ5g7TUJPbBZ/tzd2W4J/eQPoSriUfLC7AfMmL49x/71aaYhF6Tg0E7RUHjgfHg7GIObZ7R3B+8oefrZ8XrJ2Ei5g5AHpODZBKlF52Do8lSc5kSc6U3rzZyJkCpMc/J5VIkkokOd/fWXJj5iJnhiCA+miEhliU8/2dAKQSSeqjEaeL4FQBSskfjqYn0zx/6AMAhg/vDSukJXG2AN8e+Iqju/8oaDt+eyPjY4miHbLNrF8l5HukpdUAtCT6ePmNWbrMZ0v6fFMsQnxznVWPMJ3pAb/vrzav3cjNAU/9eHrxD8xjY/LBoQKUkv9YciHxzXXBsW3JB8eGIIAq1rKr7aD5cNMhBk/eyYlYK5C7PxSvreT9yxVObMB8zuwDfBvvWw/A0fYqvPe+Dtq3nPmOoXTWqeSDgz1gT1un8Zee5/s7PX9irr7lqnfmi09CjW05nOsBkNuQvd2+l1u9NdRHI+x8fAddH3fT+tzrYYe2ZE5Owg2xKFsa671Kb03Qds9dq0OMaPmc6wGpRDL3LADImqsF57teeDPM0JbFuQL4Q06p8+lJ954HOFcAyN0BHfw+Zeafn+s/FmZYIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiLyP/U3UdVQ0uBrMVkAAAAASUVORK5CYII=",Qe="/assets/Background01-ARNKK0xz.png",ne=new j;ne.add(ke,new o(ke));ne.add(Qe,new o(Qe));ne.add(f,new E(f));const z=ne,li={},Me={...li,outlineColor:new I(0,0,0,.8),outlineThickness:1},Re={...li,shadowColor:new I(0,0,0,.5),shadowOffset:[1,1],shadowBlur:1};class de{static getMaterial_Outline(t=Me){t={...Me,...t};const e=t.outlineColor||I.Black,s=`#version 300 es
      precision mediump float;

      uniform sampler2D u_graphic;

      in vec2 v_uv;
      out vec4 fragColor;

      void main() {
        vec2 texSize = vec2(textureSize(u_graphic, 0));
        vec2 uv = v_uv;
        float thickness = ${(t.outlineThickness||2).toFixed(1)};

        vec4 outlineColor = vec4(${e.r}, ${e.g}, ${e.b}, ${e.a});
        vec4 texColor = texture(u_graphic, uv);

        float outline = 0.0;
        for (float y = -thickness; y <= thickness; y += 1.0) {
          for (float x = -thickness; x <= thickness; x += 1.0) {
            vec2 sampleUV = uv + vec2(x, y) / texSize;
            outline = max(outline, texture(u_graphic, sampleUV).a);
          }
        }

        outline = outline - texColor.a;
        vec4 outlineResult = mix(texColor, outlineColor, outline);
        fragColor = outlineResult;
      }
    `;return N.instance.graphicsContext.createMaterial({name:"outline",fragmentSource:s})}static getMaterial_DropShadow(t=Re){t={...Re,...t};const e=t.shadowColor||I.fromHex("#00000080"),i=t.shadowOffset||[4,4],s=t.shadowBlur||4,l=`#version 300 es
      precision mediump float;

      uniform sampler2D u_graphic;
      uniform vec2 u_resolution;

      in vec2 v_uv;
      out vec4 fragColor;

      void main() {
        vec2 texSize = vec2(textureSize(u_graphic, 0));
        vec2 uv = v_uv;
        vec2 offset = vec2(${i[0]}.0, ${i[1]}.0) / texSize;
        float blur = ${s.toFixed(1)};

        vec4 shadowColor = vec4(${e.r}, ${e.g}, ${e.b}, ${e.a});
        vec4 texColor = texture(u_graphic, uv);

        float shadow = 0.0;
        for (float y = -blur; y <= blur; y += 1.0) {
          for (float x = -blur; x <= blur; x += 1.0) {
            vec2 sampleUV = uv + offset + vec2(x, y) / texSize;
            shadow += texture(u_graphic, sampleUV).a;
          }
        }
        shadow /= (2.0 * blur + 1.0) * (2.0 * blur + 1.0);

        vec4 shadowResult = mix(vec4(0.0), shadowColor, shadow);
        fragColor = mix(shadowResult, texColor, texColor.a);
      }
    `;return N.instance.graphicsContext.createMaterial({name:"dropshadow",fragmentSource:l})}}const Ue={collisionType:v.Active,collisionGroup:ee.Player,imageSource:z.get("KnightStatic01"),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:30,unit:d.Percent},height:{value:30,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeHeight},positionLayoutConfiguration:{x:{value:50,unit:d.Percent},y:{value:50,unit:d.Percent},relativeTo:g.Screen}}};class Xi extends F{constructor(e=Ue){e={...Ue,...e};super(e);a(this,"_moveSpeed",3e3);a(this,"_flipHorizontal",!1)}onInitialize(){const e=this.configuration.imageSource.toSprite();e.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.add(e),this.graphics.material=de.getMaterial_DropShadow(),this.collider.set(new W({radius:Math.max(e.width/2,e.height/2)}))}async move(e,i,s){s=s.scale(this._moveSpeed*(i/1e3)),this.pos=this.pos.add(s),s.x!==0&&(this._flipHorizontal=s.x>0,this.graphics.flipHorizontal=this._flipHorizontal),h.scaleDownAndUpAsync(this),O.particlesAddDustAsync(this,{duration:100})}}const X={},Te={...X,pixelSize:4,colorLevels:5,scanlineIntensity:.1,bulgeIntensity:-.2};class Ki{static getPostProcessor_ColorBlindness(t=X){return t={...X,...t},new Si(yi.Deuteranope,!0)}static getPostProcessor_GrayScale(t=X){return t={...X,...t},new class{constructor(){a(this,"_shader")}initialize(i){this._shader=new he(i,`#version 300 es
        precision mediump float;
        // our texture
        uniform sampler2D u_image;
        // the texCoords passed in from the vertex shader.
        in vec2 v_texcoord;
        out vec4 fragColor;
        void main() {
          vec4 tex = texture(u_image, v_texcoord);
          float avg = 0.2126 * tex.r + 0.7152 * tex.g + 0.0722 * tex.b;
          fragColor = vec4(avg, avg, avg, 1.0);
        }`)}getLayout(){return this._shader.getLayout()}getShader(){return this._shader.getShader()}}}static getPostProcessor_Retro(t=Te){t={...Te,...t};const e=t.pixelSize||4,i=t.colorLevels||5,s=t.scanlineIntensity||.1,l=t.bulgeIntensity||.1;return new class{constructor(){a(this,"_shader")}initialize(A){this._shader=new he(A,`#version 300 es
        precision mediump float;
        uniform sampler2D u_image;
        uniform vec2 u_resolution;
        in vec2 v_texcoord;
        out vec4 fragColor;

        vec2 bulge(vec2 uv) {
          vec2 center = vec2(0.5, 0.5);
          vec2 d = uv - center;
          float r = length(d);
          float bulgeAmount = ${l};
          
          // Adjust the bulge function to be less pronounced near the edges
          float bulge = 1.0 + bulgeAmount * (1.0 - r * r);
          
          // Smoothstep to further reduce the effect near the edges
          float edgeFade = smoothstep(0.7, 0.0, r);
          bulge = mix(1.0, bulge, edgeFade);
          
          return center + d * bulge;
        }

        void main() {
          vec2 uv = v_texcoord;
          
          // Apply screen bulge
          uv = bulge(uv);
          
          // Pixelation
          vec2 pixels = vec2(${e}.0, ${e}.0);
          uv = floor(uv * u_resolution / pixels) * pixels / u_resolution;
          
          vec4 tex = texture(u_image, uv);
          
          // Color quantization
          float colorLevels = ${i}.0;
          tex = floor(tex * colorLevels) / colorLevels;
          
          // Scanline effect
          float scanline = sin(uv.y * u_resolution.y * 2.0) * ${s};
          tex.rgb -= scanline;

          fragColor = tex;
        }`)}getLayout(){return this._shader.getLayout()}getShader(){return this._shader.getShader()}}}}class qi extends J{constructor(){super();a(this,"_player");a(this,"_background")}async initializeAsync(){if(this.isInitialized)return Promise.resolve();await z.initializeAsync(),this.start(z.loader),await super.initializeAsync(),this.initializeBackground(),this.initializePlayer(),this.model.score.value=0,this.model.lives.value=3,this.model.gameState.value=p.GameInitialized,Ki.getPostProcessor_GrayScale()}initializeBackground(){const e={imageSource:z.get("Background01"),isScrolling:!1};this._background=new Z(e),this.currentScene.add(this._background)}initializePlayer(){this._player=new Xi,this.currentScene.add(this._player)}handlePlayerInput(e,i){this.controller.left.wasPressed?(this._player.move(e,i,new u(-1,0)),z.get("Hit01").play(),this.model.score.value+=1):this.controller.right.wasPressed?(this._player.move(e,i,new u(1,0)),z.get("Hit01").play(),this.model.score.value+=1):this.controller.up.wasPressed?(this._player.move(e,i,new u(0,-1)),z.get("Hit01").play(),this.model.score.value+=1):this.controller.down.wasPressed&&(this._player.move(e,i,new u(0,1)),z.get("Hit01").play(),this.model.score.value+=1),this.controller.action.wasPressed&&(z.get("Hit01").play(),this.model.lives.value-=1)}onPreUpdate(e,i){super.onPreUpdate(e,i),this.handlePlayerInput(e,i)}onModelChanged(){this.model.lives.value==0&&console.log("Gameover")}}const Ne="/assets/CardBack01-DXwIKA7u.png",We="/assets/CardBack02-DUpQ-E5u.png",Le="/assets/CardBack03-DGzYl7FS.png",Ye="/assets/CardBack04-DTxA2UUe.png",je="/assets/CardBack05-slyTMGop.png",Ze="/assets/CardBack06-Bjq2kgCT.png",Oe="/assets/CardBack07-DWAOzta8.png",Je="/assets/CardBack08-DZhtbMp9.png",Xe="/assets/CardFront_SuitClubs_Value01-BuZs2jsf.png",Ke="/assets/CardFront_SuitClubs_Value02-B054NjHA.png",qe="/assets/CardFront_SuitClubs_Value03-8SFfJPpZ.png",$e="/assets/CardFront_SuitClubs_Value04-3oxnWL7A.png",et="/assets/CardFront_SuitClubs_Value05-B-STfTgH.png",tt="/assets/CardFront_SuitClubs_Value06-EBdGkyQj.png",it="/assets/CardFront_SuitClubs_Value07-C_Ox3_GA.png",st="/assets/CardFront_SuitClubs_Value08--nT5jNr9.png",at="/assets/CardFront_SuitClubs_Value09-BOM4pjye.png",ot="/assets/CardFront_SuitClubs_Value10-B9ZXKlEs.png",nt="/assets/CardFront_SuitClubs_Value11-ta9wZbHQ.png",rt="/assets/CardFront_SuitClubs_Value12-BUrVzsl9.png",lt="/assets/CardFront_SuitClubs_Value13-BynQE2so.png",dt="/assets/CardFront_SuitDiamonds_Value01-DuGct1D4.png",ct="/assets/CardFront_SuitDiamonds_Value02-Cxcs3_a6.png",At="/assets/CardFront_SuitDiamonds_Value03-CYyi5I6A.png",ut="/assets/CardFront_SuitDiamonds_Value04-DlAVoHcR.png",ht="/assets/CardFront_SuitDiamonds_Value05-BI3JDtJf.png",gt="/assets/CardFront_SuitDiamonds_Value06-BbyI4tZZ.png",pt="/assets/CardFront_SuitDiamonds_Value07-Bc1Wy0et.png",wt="/assets/CardFront_SuitDiamonds_Value08-BRkR0AbM.png",Ct="/assets/CardFront_SuitDiamonds_Value09-BjhDggbq.png",mt="/assets/CardFront_SuitDiamonds_Value10-p5zJ4kSV.png",_t="/assets/CardFront_SuitDiamonds_Value11-CGhHhdyD.png",St="/assets/CardFront_SuitDiamonds_Value12-Dul94hb4.png",yt="/assets/CardFront_SuitDiamonds_Value13-O45A4SPn.png",ft="/assets/CardFront_SuitSpades_Value01-BSquNY4W.png",vt="/assets/CardFront_SuitSpades_Value02-qizO4H7d.png",Bt="/assets/CardFront_SuitSpades_Value03-oYkQEfiT.png",Pt="/assets/CardFront_SuitSpades_Value04-BJNOX-Lt.png",It="/assets/CardFront_SuitSpades_Value05-C9-P9wTa.png",Dt="/assets/CardFront_SuitSpades_Value06-K1oGJnOv.png",bt="/assets/CardFront_SuitSpades_Value07-xiNvQO4u.png",Ft="/assets/CardFront_SuitSpades_Value08-BbjXw3VN.png",zt="/assets/CardFront_SuitSpades_Value09-BPPMA40g.png",Et="/assets/CardFront_SuitSpades_Value10-CaYhLnPg.png",xt="/assets/CardFront_SuitSpades_Value11-CeRqPVAZ.png",Ht="/assets/CardFront_SuitSpades_Value12-u7kplPXW.png",Gt="/assets/CardFront_SuitSpades_Value13-BQE93ZiK.png",Vt="/assets/CardFront_SuitHearts_Value01-COL3fmc4.png",kt="/assets/CardFront_SuitHearts_Value02-Bn0QkN6D.png",Qt="/assets/CardFront_SuitHearts_Value03-DJ7OxlVs.png",Mt="/assets/CardFront_SuitHearts_Value04-B_Ze5rJh.png",Rt="/assets/CardFront_SuitHearts_Value05-CmGflwi-.png",Ut="/assets/CardFront_SuitHearts_Value06-Cjxky7BD.png",Tt="/assets/CardFront_SuitHearts_Value07-BcJY5VQq.png",Nt="/assets/CardFront_SuitHearts_Value08-B5RsHpqV.png",Wt="/assets/CardFront_SuitHearts_Value09-BIc9ndQg.png",Lt="/assets/CardFront_SuitHearts_Value10-BRluuZd6.png",Yt="/assets/CardFront_SuitHearts_Value11-Dc47zjok.png",jt="/assets/CardFront_SuitHearts_Value12-Don2PsEg.png",Zt="/assets/CardFront_SuitHearts_Value13-BeXolkUc.png",Ot="/assets/Background01-CE6cpeWh.png";var ce=(n=>(n[n.Hearts=0]="Hearts",n[n.Diamonds=1]="Diamonds",n[n.Clubs=2]="Clubs",n[n.Spades=3]="Spades",n))(ce||{});class $i{constructor(t,e){this.suit=t,this.value=e}get displayValue(){switch(this.value){case 1:return"A";case 11:return"J";case 12:return"Q";case 13:return"K";default:return this.value.toString()}}}class es extends j{constructor(){super()}getCardFrontByCard(t){const e=t.value<10?`0${t.value.toString()}`:t.value.toString(),i=`CardFront_Suit${ce[t.suit]}_Value${e}`;return this.has(i)||console.log(`ERROR:Check assets. ImageSource not found for ${i}`),this.get(i)}}const r=new es;r.add(Ot,new o(Ot));r.add(Ne,new o(Ne));r.add(We,new o(We));r.add(Le,new o(Le));r.add(Ye,new o(Ye));r.add(je,new o(je));r.add(Ze,new o(Ze));r.add(Oe,new o(Oe));r.add(Je,new o(Je));r.add(Xe,new o(Xe));r.add(Ke,new o(Ke));r.add(qe,new o(qe));r.add($e,new o($e));r.add(et,new o(et));r.add(tt,new o(tt));r.add(it,new o(it));r.add(st,new o(st));r.add(at,new o(at));r.add(ot,new o(ot));r.add(nt,new o(nt));r.add(rt,new o(rt));r.add(lt,new o(lt));r.add(dt,new o(dt));r.add(ct,new o(ct));r.add(At,new o(At));r.add(ut,new o(ut));r.add(ht,new o(ht));r.add(gt,new o(gt));r.add(pt,new o(pt));r.add(wt,new o(wt));r.add(Ct,new o(Ct));r.add(mt,new o(mt));r.add(_t,new o(_t));r.add(St,new o(St));r.add(yt,new o(yt));r.add(ft,new o(ft));r.add(vt,new o(vt));r.add(Bt,new o(Bt));r.add(Pt,new o(Pt));r.add(It,new o(It));r.add(Dt,new o(Dt));r.add(bt,new o(bt));r.add(Ft,new o(Ft));r.add(zt,new o(zt));r.add(Et,new o(Et));r.add(xt,new o(xt));r.add(Ht,new o(Ht));r.add(Gt,new o(Gt));r.add(Vt,new o(Vt));r.add(kt,new o(kt));r.add(Qt,new o(Qt));r.add(Mt,new o(Mt));r.add(Rt,new o(Rt));r.add(Ut,new o(Ut));r.add(Tt,new o(Tt));r.add(Nt,new o(Nt));r.add(Wt,new o(Wt));r.add(Lt,new o(Lt));r.add(Yt,new o(Yt));r.add(jt,new o(jt));r.add(Zt,new o(Zt));r.add(f,new E(f));const b=r;class ts{constructor(){a(this,"cards",[]);this.initializeDeck()}initializeDeck(){for(let t of Object.values(ce).filter(e=>typeof e=="number"))for(let e=1;e<=13;e++)this.cards.push(new $i(t,e))}shuffle(){for(let t=this.cards.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this.cards[t],this.cards[e]]=[this.cards[e],this.cards[t]]}}drawCard(){return this.cards.pop()}}class is{constructor(){a(this,"cards",[])}addCard(t){this.cards.push(t)}getCards(){return this.cards}getScore(){let t=0,e=0;for(const i of this.cards)i.value===1?(e++,t+=11):t+=Math.min(i.value,10);for(;t>21&&e>0;)t-=10,e--;return t}clear(){this.cards=[]}}class Jt{constructor(t,e=new is){this.name=t,this.hand=e}}const ss={imageSourceCardBack:b.get("CardBack01"),imageSourceCardFront:b.get("CardBack01"),imageSource:b.get("CardBack01"),isFront:!1,layoutConfiguration:{sizeLayoutConfiguration:{width:{value:20,unit:d.Percent},height:{value:20,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeHeight}}};class as extends F{constructor(e){super(ss);a(this,"_moveSpeed",3e3);a(this,"_card");a(this,"_isFront",!1);this._card=e,this.isFront=this.configuration.isFront}get isFront(){return this._isFront}get card(){return this._card}set isFront(e){this._isFront=e,this.updateVisuals()}get configuration(){return this._configuration}onInitialize(){this.updateVisuals()}updateVisuals(){this.configuration.imageSourceCardFront=b.getCardFrontByCard(this._card);const e=this.isFront?this.configuration.imageSourceCardFront.toSprite():this.configuration.imageSourceCardBack.toSprite();e.scale=this.layoutEngine.getCalculatedScale(this.configuration.imageSource),this.graphics.add(e),this.collider.set(new W({radius:Math.max(e.width/2,e.height/2)}))}async move(e,i,s){s=s.scale(this._moveSpeed*(i/1e3)),this.pos=this.pos.add(s),h.scaleDownAndUpAsync(this),O.particlesAddDustAsync(this,{duration:100})}}class k{}a(k,"CardWidthPercentage",20),a(k,"CardHeightPercentage",20);const os={name:"Deck",imageSource:b.get("CardBack05"),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:k.CardWidthPercentage,unit:d.Percent},height:{value:k.CardHeightPercentage,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeHeight},positionLayoutConfiguration:{x:{value:15,unit:d.Percent},y:{value:10,unit:d.Percent},relativeTo:g.Screen}}};class ns extends F{constructor(e){super(os);a(this,"_deck");this._deck=e,this.name="My deck"}drawCard(e){const i=this._deck.drawCard();if(i){const s=new as(i);return s.pos=this.pos.clone(),s.isFront=e,this.addChild(s),s}}}const rs={name:"Dealer",imageSource:b.get("CardBack03"),positionOffsetPercentage:w(.3,0),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:k.CardWidthPercentage,unit:d.Percent},height:{value:k.CardHeightPercentage,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeHeight},positionLayoutConfiguration:{x:{value:40,unit:d.Percent},y:{value:20,unit:d.Percent},relativeTo:g.Screen}}},ls={name:"Player",imageSource:b.get("CardBack04"),positionOffsetPercentage:w(.3,0),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:k.CardWidthPercentage,unit:d.Percent},height:{value:k.CardHeightPercentage,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeHeight},positionLayoutConfiguration:{x:{value:60,unit:d.Percent},y:{value:80,unit:d.Percent},relativeTo:g.Screen}}};class Xt extends F{constructor(e,i){super(i);a(this,"_cardActors");a(this,"_player");this._cardActors=[],this._player=e}get cardActors(){return this._cardActors}get player(){return this._player}get configuration(){return this._configuration}onInitialize(e){super.onInitialize(e),console.log(this._player.name,this.pos)}clearCardActors(){this._cardActors.forEach(e=>e.kill())}async addCardActorAsync(e){this._cardActors.push(e);const i=this.pos.add(this.configuration.positionOffsetPercentage.scale(this.width*this.cardActors.length));await h.moveToAsync(e,i,{duration:200})}}class ds extends J{constructor(){super();a(this,"_background");a(this,"_deckActor");a(this,"_playerHandActor");a(this,"_dealerHandActor")}async initializeAsync(){if(this.isInitialized)return Promise.resolve();await b.initializeAsync(),this.start(b.loader),await super.initializeAsync(),this.initializeBackground(),this.initializeGame(),this.model.score.value=0,this.model.lives.value=3,this.model.gameState.value=p.GameInitialized}initializeBackground(){const e={imageSource:b.get("Background01"),isScrolling:!1};this._background=new Z(e),this.currentScene.add(this._background)}initializeGame(){const e=new ts;this._deckActor=new ns(e),this.currentScene.add(this._deckActor);const i=new Jt("Player"),s=new Jt("Dealer");this._playerHandActor=new Xt(i,ls),this.currentScene.add(this._playerHandActor),this._dealerHandActor=new Xt(s,rs),this.currentScene.add(this._dealerHandActor),this.startNewRound()}async startNewRound(){this._playerHandActor.clearCardActors(),this._dealerHandActor.clearCardActors(),await this.dealCardToPlayer(this._playerHandActor,!0),await this.dealCardToPlayer(this._dealerHandActor,!1),await this.dealCardToPlayer(this._playerHandActor,!0),await this.dealCardToPlayer(this._dealerHandActor,!0),this.updateScore()}async dealCardToPlayer(e,i){const s=this._deckActor.drawCard(i);s&&e.addCardActorAsync(s)}updateScore(){this.model.score.value=this._playerHandActor.player.hand.getScore()}async dealerTurn(){for(this._dealerHandActor.cardActors[0].isFront=!1;this._dealerHandActor.player.hand.getScore()<17;)await new Promise(e=>setTimeout(e,1e3)),await this.dealCardToPlayer(this._dealerHandActor,!0)}async endRound(e){await this.dealerTurn(),e?this.model.lives.value+=1:this.model.lives.value-=1,this.model.lives.value<=0?this.gameOver():setTimeout(()=>this.startNewRound(),2e3)}gameOver(){console.log("Game Over"),this.model.gameState.value!==p.GameEnded&&(this.model.gameState.value=p.GameEnded)}handlePlayerInput(e,i){this.controller.action.wasPressed&&this.handlePlayerAction()}async handlePlayerAction(){await this.dealCardToPlayer(this._playerHandActor,!0),this.updateScore(),this._playerHandActor.player.hand.getScore()>21?this.endRound(!1):this._playerHandActor.player.hand.getScore()===21&&this.endRound(!0)}onPreUpdate(e,i){super.onPreUpdate(e,i),this.handlePlayerInput(e,i)}onModelChanged(){this.model.lives.value==0&&this.gameOver()}}class cs{constructor(){a(this,"_isInitialized",!1);a(this,"_gameIndex",0);a(this,"_gameCurrent");a(this,"_games",[])}get isInitialized(){return this._isInitialized}get gameCount(){return this._games.length}get gameCurrent(){return this._gameCurrent}requireIsInitialized(){throw new Error("Method not implemented.")}async initializeAsync(){}addGame(t){this._games.push(t)}async showNextGameAsync(){let t=this._gameIndex+1;t>=this._games.length&&(t=0),await this.loadGameAtIndexAsync(t)}async showPreviousGameAsync(){let t=this._gameIndex-1;t<0&&(t=this._games.length-1),await this.loadGameAtIndexAsync(t)}async showGameAtIndexAsync(t){await this.loadGameAtIndexAsync(t)}async loadGameAtIndexAsync(t){var s;let e=null;this._gameCurrent&&(console.log("Warning: Disposing an existing game is not working!"),e=this._gameCurrent.canvas.cloneNode(),(s=this._gameCurrent)==null||s.dispose()),await h.awaitTimeAsync(200),e&&document.body.appendChild(e);const i=this._games[t];this._gameCurrent=new i,N.instance=this._gameCurrent,await this._gameCurrent.initializeAsync()}}const Kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAkCAYAAACXOioTAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AgLEwILajZZrAAAAoVJREFUSIndlj9oE2EYh59IoejkoItDLU1ocEhah0oyK11Sgw5utoJDcYml0OBSEepmxFACKqVUiNXBgq2WIBYCbj3IEpMhnFxCqvhnEJcO9aZzSL/z7nKXfNfUDv4g5Pu+XO7J+76/980FDMPgKHTsSCj/JajP7XAnHbcV7mxmO9ArqC0iJ8TrzK9cI/r28ScASlMHoJZME8lvGQCpqXEA3xHaItpJxw0BEaol00SiYQDGoiGUcgPAd4SeZlCaehvE/OwAMFeQgHSSX5gJOoyCS4GgZQJhAKcmLl1oe8/lt/yDrL0y++mzua5WVPPiUkWTvrEnCLBFs/QwZYPde/SyJ2DAOr2zwwOGNRqA6bmceYFwoFBqaly6n7rOOmdk4uUHApbJkB0e8HTdubcZAGKD/QCcGTkFpPxw7KlzU25/9GysFZhQ120wP8O2Y+pEfcRUqCXTKE0dpanz+s1XWQbgMVStGouGWFkt/P3C/LK5VsoN4/FkwtznqzXPCLuaYWW1QF11t3OpoqHt6mi77k0uDaqrGnVVo7i56NrAftQxdcFwyNY7dVUjGA4dCNa1Rk5Z0/jjS5NbC08BKGVmDgdUnH9HdvK37Wz5xHmqFbVtYripYx9dvDxjAEyo68ze3SNnvJD9XUDLsbHRIYCApxl+3TltBMMhrlxLcOPqni+AEwI+a2T9O/fS/s2FTLd2HUHQmhBLIwtsPz/Js+htoDX/YoP9PPne17FRhaSfVLP3jxN48N7cx199QGnqUhCQiGh6LmcISxc3FwPCINYmlpFUjYLhEDevJ8y1jJ2dkkpdJBomNjrU0/N3V1Bd1dhYK3juZdU1dc5U/dPUVSsqSrlheO1l9Af7CQ80LrcZWQAAAABJRU5ErkJggg==",qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAAgCAYAAABjE6FEAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAB3RJTUUH6AgLEgMPdYLGwwAAASFJREFUeJzt3S1OA1EYheHThn00tRVNNwCSBIFjCTUIEKyDBcBWkLADREWTJq3pNorgJ2U6tjPJfM8jrzrqzU2uuKPpZHEIQEEXSbJ8vO97B0BnZvNZnpYPGSfJZr3rew9AJ2bzWVafqyT5DmAigsDwHccvOQpgIoLAcDXjlzQCmIggMDxt8Ut+HkGaNutdbu9uzj4KoAtt8UtaboAAVQggUJYAAmUJIFCWAAJlCSBQlgACZQkgUJYAAmUJIFCWAAJlCSBQlgACZQkgUJYAAmUJIFCWAAJlCSBQlgACZbX+CbLf7vL6/NL1FoCzuby+Ojk7uQHut36FA4bn4+395OxfAMUPGLJmBP8CKH5ABccRHCfiB9TyG8HRdLI49LwFoBdfBWI7QCIL9k0AAAAASUVORK5CYII=",$t="/assets/Background01-D9PQuw6L.png",te=new j;te.add(Kt,new o(Kt));te.add(qt,new o(qt));te.add($t,new o($t));te.add(f,new E(f));const U=te,As=L.create("DonkeyKongPlayer"),Ae=L.create("DonkeyKongPlatform"),di=L.create("DonkeyKongBarrel"),us=$.collidesWith([Ae,di]),hs=$.collidesWith([Ae]),ci={Player:us,Barrel:hs,PlayerGroup:As,PlatformGroup:Ae,BarrelGroup:di},ei={collisionType:v.Active,collisionGroup:ci.Player,imageSource:U.get("Hero01"),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:10,unit:d.Percent},height:{value:10,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeHeight},positionLayoutConfiguration:{x:{value:50,unit:d.Percent},y:{value:10,unit:d.Percent},relativeTo:g.Screen}}};class gs extends F{constructor(e=ei){e={...ei,...e};super(e);a(this,"_moveSpeed",3e3);a(this,"_flipHorizontal",!1)}onInitialize(e){super.onInitialize(e),this.graphics.material=de.getMaterial_DropShadow()}async move(e,i,s){s=s.scale(this._moveSpeed*(i/1e3)),this.pos=this.pos.add(s),s.x!==0&&(this._flipHorizontal=s.x>0,this.graphics.flipHorizontal!=this._flipHorizontal&&(this.graphics.flipHorizontal=this._flipHorizontal,O.particlesAddDustAsync(this,{duration:100})))}jump(e){this.body.applyLinearImpulse(new u(0,-e))}}const ti={collisionType:v.Fixed,collisionGroup:ci.PlatformGroup,anchor:w(.5,.5),imageSource:U.get("Platform01"),layoutConfiguration:{sizeLayoutConfiguration:{width:{value:80,unit:d.Percent},height:{value:80,unit:d.Percent},relativeTo:g.Screen,scaleAspectRatio:D.PrioritizeWidth},positionLayoutConfiguration:{x:{value:50,unit:d.Percent},y:{value:50,unit:d.Percent},relativeTo:g.Screen}}};class ie extends F{constructor(t=ti){t={...ti,...t},super(t)}onInitialize(t){super.onInitialize(t),this.graphics.material=de.getMaterial_DropShadow()}}class ps extends J{constructor(){super();a(this,"_player");a(this,"_platforms",[]);a(this,"_background");a(this,"_speedX",.05);a(this,"_speedY",200)}async initializeAsync(){if(this.isInitialized)return Promise.resolve();await U.initializeAsync(),this.start(U.loader),await super.initializeAsync(),await this.initializeBackground(),await this.initializeLevel(),await this.initializePlayer(),await h.awaitNextFrameAsync(),this._player.body.collisionType=v.Active,this._player.body.friction=1,this._player.body.limitDegreeOfFreedom=[fi.Rotation],this.model.score.value=0,this.model.lives.value=3,this.model.gameState.value=p.GameInitialized}initializeBackground(){const e={imageSource:U.get("Background01"),isScrolling:!1};this._background=new Z(e),this.currentScene.add(this._background)}async initializeLevel(){this._platforms.push(new ie({rotation:.1})),this._platforms.push(new ie({rotation:-.1})),this._platforms.push(new ie({rotation:.1})),this._platforms.push(new ie({rotation:-.1})),this._platforms.forEach(async(s,l)=>{this.currentScene.add(s)});const e=.2,i=.2;await h.awaitNextFrameAsync(),this._platforms.forEach(async(s,l)=>{s.pos.y=this.drawHeight*(e+i*l)})}async initializePlayer(){this._player=new gs,this.currentScene.add(this._player)}handlePlayerInput(e,i){(this.controller.left.wasPressed||this.controller.right.wasPressed)&&(this.controller.up.wasPressed||this.controller.down.wasPressed||this._player.move(e,i,new u(0,1)),U.get("Hit01").play()),this.controller.left.isHeld?this._player.move(e,i,new u(-this._speedX,0)):this.controller.right.isHeld?this._player.move(e,i,new u(this._speedX,0)):this.controller.up.isHeld?this._player.jump(this._speedY):this.controller.down.isHeld,this.controller.action.wasPressed&&(U.get("Hit01").play(),this.model.lives.value-=1)}onPreUpdate(e,i){super.onPreUpdate(e,i),this.handlePlayerInput(e,i)}onModelChanged(){this.model.lives.value==0&&console.log("Gameover")}}const y=new cs;y.addGame(qi);y.addGame(Ti);y.addGame(ji);y.addGame(Ji);y.addGame(ds);y.addGame(ps);(async()=>{await y.initializeAsync();let n=Math.round(Math.random()*(y.gameCount-1));n=0,n=y.gameCount-1,await y.showGameAtIndexAsync(n);const t=new vi(y.gameCurrent);t.collider={showAll:!0,showBounds:!0,boundsColor:new I(0,255,0,.5),showOwner:!0,showGeometry:!0,geometryColor:new I(255,0,255,.5),geometryLineWidth:1,geometryPointSize:1},y.gameCurrent.debug=t})();
